---
description: '詳細情報: 外部リソースの解決'
title: 外部リソースの解決
ms.date: 03/30/2017
ms.assetid: ad3fa320-4b8f-4e5c-b549-01157591007a
ms.openlocfilehash: 8dcd508c2bc811601c6ae8fdbef40209ae520dcd
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99783067"
---
# <a name="resolving-external-resources"></a><span data-ttu-id="8aef0-103">外部リソースの解決</span><span class="sxs-lookup"><span data-stu-id="8aef0-103">Resolving External Resources</span></span>

<span data-ttu-id="8aef0-104">**XmlDocument** クラスでは、外部のドキュメント型定義 (DTD)、エンティティ、スキーマなど、XML データのインラインでないリソースを検索するときに **XmlDocument** の **XmlResolver** プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-104">The **XmlResolver** property of the **XmlDocument** is used by the **XmlDocument** class to locate resources that are not inline in the XML data, such as external document type definitions (DTDs), entities, and schemas.</span></span> <span data-ttu-id="8aef0-105">これらのリソースは、ネットワーク上やローカル ドライブ上にあり、URI (Uniform Resource Identifier) で識別できます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-105">These items can be located on a network or on a local drive, and are identifiable by a Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="8aef0-106">そのため、**XmlDocument** は、ドキュメント内にある **EntityReference** ノードを解決し、外部の DTD またはスキーマに基づいてドキュメントを検証することができます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-106">This allows the **XmlDocument** to resolve **EntityReference** nodes that are present in the document and validate the document according to the external DTD or schema.</span></span>  
  
## <a name="fully-trusted-xmldocument"></a><span data-ttu-id="8aef0-107">完全に信頼されている XmlDocument</span><span class="sxs-lookup"><span data-stu-id="8aef0-107">Fully-Trusted XmlDocument</span></span>  

 <span data-ttu-id="8aef0-108">**XmlResolver** プロパティは、**XmlDocument.Load** メソッドの機能に影響を与えることがあります。</span><span class="sxs-lookup"><span data-stu-id="8aef0-108">The **XmlResolver** property affects the functionality of the **XmlDocument.Load** method.</span></span> <span data-ttu-id="8aef0-109">**XmlDocument** オブジェクトが完全に信頼されている場合の **XmlDocument.XmlResolver** プロパティの動作を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-109">The table below shows how the **XmlDocument.XmlResolver** property works when the **XmlDocument** object is fully trusted.</span></span> <span data-ttu-id="8aef0-110">Load への入力が **TextReader**、**String**、**Stream**、または **URI** である場合の **XmlDocument.Load** メソッドが対象です。</span><span class="sxs-lookup"><span data-stu-id="8aef0-110">The following table shows the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="8aef0-111">**XmlDocument** が **XmlReader** から読み込まれた場合の **Load** メソッドは対象外です。</span><span class="sxs-lookup"><span data-stu-id="8aef0-111">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="8aef0-112">XmlResolver プロパティ</span><span class="sxs-lookup"><span data-stu-id="8aef0-112">XmlResolver property</span></span>|<span data-ttu-id="8aef0-113">関数</span><span class="sxs-lookup"><span data-stu-id="8aef0-113">Function</span></span>|<span data-ttu-id="8aef0-114">メモ</span><span class="sxs-lookup"><span data-stu-id="8aef0-114">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="8aef0-115">プロパティが、以前作成され、ユーザーの設定したプロパティを持っている **XmlResolver** クラスに設定されている。</span><span class="sxs-lookup"><span data-stu-id="8aef0-115">The property is set to an **XmlResolver** class that has been previously created and has properties already set on it by the user.</span></span>|<span data-ttu-id="8aef0-116">**XmlDocument** は、ファイル名を解決するために指定された **XmlResolver** を使用し、DTD、エンティティ、スキーマなどの外部リソースへの参照を解決します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-116">The **XmlDocument** uses the **XmlResolver** that is given to resolve file names, to resolve references to external resources such as DTDs, entities, and schemas.</span></span><br /><br /> <span data-ttu-id="8aef0-117">**XmlResolver** は、**XmlDocument** のノードの追加や編集に必要な外部リソースを解決するときにも使用されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-117">The **XmlResolver** is also used when resolving external resources that are needed when adding or editing nodes in the **XmlDocument**.</span></span>|<span data-ttu-id="8aef0-118">**XmlDocument** に指定された **XmlResolver** は、外部リソースの検索と解決が必要な場合に常に使用されるリゾルバーです。</span><span class="sxs-lookup"><span data-stu-id="8aef0-118">The **XmlResolver** given to the **XmlDocument** is the resolver that is used whenever external resources need to be located and resolved.</span></span>|  
|<span data-ttu-id="8aef0-119">プロパティが **null** (Microsoft Visual Basic .NET では **Nothing**) に設定されている。</span><span class="sxs-lookup"><span data-stu-id="8aef0-119">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="8aef0-120">外部のスキーマや DTD の検索など、外部リソースを必要とする機能はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-120">Features that require an external resource are not supported, such as locating an external schema, or DTD.</span></span> <span data-ttu-id="8aef0-121">外部エンティティの解決も行われず、解決が必要なエンティティ ノードの挿入などの編集機能もサポートされません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-121">Nor will external entities be resolved, and performing editing functions, such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="8aef0-122">**XmlDocument** は、ファイルを匿名で読み込みます。他のリソースを解決しようとはしません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-122">The **XmlDocument** loads files as anonymous and does not attempt to resolve any other resources.</span></span>|  
|<span data-ttu-id="8aef0-123">プロパティが設定されておらず、既定状態のままである。</span><span class="sxs-lookup"><span data-stu-id="8aef0-123">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="8aef0-124">ファイル名を解決したり、外部の DTD、エンティティ、スキーマを検索するときは、NULL 資格情報を持つ **XmlUrlResolver** のインスタンスが作成され、**XmlDocument** によって使用されます。ノードを編集するときは、**null** 資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-124">An **XmlUrlResolver** with NULL credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>||  
  
 <span data-ttu-id="8aef0-125">**Load** への入力が **XmlReader** であり、**XmlDocument** が完全に信頼されている場合の **XmlDocument.Load** メソッドを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-125">The following table shows the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader** and the **XmlDocument** is fully trusted.</span></span>  
  
|<span data-ttu-id="8aef0-126">XmlResolver プロパティ</span><span class="sxs-lookup"><span data-stu-id="8aef0-126">XmlResolver property</span></span>|<span data-ttu-id="8aef0-127">関数</span><span class="sxs-lookup"><span data-stu-id="8aef0-127">Function</span></span>|<span data-ttu-id="8aef0-128">メモ</span><span class="sxs-lookup"><span data-stu-id="8aef0-128">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="8aef0-129">**XmlDocument** で使用される **XmlResolver** クラスが、**XmlReader** で使用されるクラスと同じである。</span><span class="sxs-lookup"><span data-stu-id="8aef0-129">The **XmlResolver** class used by the **XmlDocument** is the same class being used by the **XmlReader**.</span></span>|<span data-ttu-id="8aef0-130">**XmlDocument** は、**XmlReader** に割り当てられた **XmlResolver** を使用します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-130">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="8aef0-131">**XmlReader**  から **XmlResolver** を取得しているため、**XmlDocument** の信頼レベルにかかわらず、**XmlDocument.Resolver** プロパティは設定できません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-131">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="8aef0-132">**XmlDocument** の **XmlResolver** プロパティを設定することによって **XmlReaders** の **XmlResolver** の設定をオーバーライドすることはできません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-132">You cannot attempt to override the settings of the **XmlReaders**' **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="8aef0-133">**XmlReader** は、**XmlTextReader**、**XmlValidatingReader**、または独自に作成したリーダーにすることができます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-133">The **XmlReader** can be the **XmlTextReader**, **XmlValidatingReader**, or a custom-written reader.</span></span> <span data-ttu-id="8aef0-134">使用するリーダーでエンティティ解決がサポートされている場合は、外部エンティティが解決されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-134">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="8aef0-135">渡されたリーダーでエンティティ参照がサポートされていない場合は、エンティティ参照は解決されません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-135">If the reader passed does not support entity references, then entity references are not resolved.</span></span>|  
  
## <a name="semi-trusted-xmldocument"></a><span data-ttu-id="8aef0-136">信頼性の高くない XmlDocument</span><span class="sxs-lookup"><span data-stu-id="8aef0-136">Semi-Trusted XmlDocument</span></span>  

 <span data-ttu-id="8aef0-137">オブジェクトの信頼性が高くない場合の **XmlDocument.XmlResolver** プロパティの動作を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-137">The following table shows how the **XmlDocument.XmlResolver** property works when the object is semi-trusted.</span></span> <span data-ttu-id="8aef0-138">Load への入力が **TextReader**、**String**、**Stream**、または **URI** である場合の **XmlDocument.Load** メソッドが対象です。</span><span class="sxs-lookup"><span data-stu-id="8aef0-138">This table applies to the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="8aef0-139">**XmlDocument** が **XmlReader** から読み込まれた場合の **Load** メソッドは対象外です。</span><span class="sxs-lookup"><span data-stu-id="8aef0-139">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="8aef0-140">XmlResolver プロパティ</span><span class="sxs-lookup"><span data-stu-id="8aef0-140">XmlResolver property</span></span>|<span data-ttu-id="8aef0-141">関数</span><span class="sxs-lookup"><span data-stu-id="8aef0-141">Function</span></span>|<span data-ttu-id="8aef0-142">メモ</span><span class="sxs-lookup"><span data-stu-id="8aef0-142">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="8aef0-143">信頼性が高くないシナリオでは、**XmlResolver** プロパティは null 以外に設定できない。</span><span class="sxs-lookup"><span data-stu-id="8aef0-143">In the semi-trusted scenario, the **XmlResolver** property cannot be set to anything other than null.</span></span>|<span data-ttu-id="8aef0-144">ファイル名を解決したり、外部の DTD、エンティティ、スキーマを検索するときは、**null** 資格情報を持つ **XmlUrlResolver** のインスタンスが作成され、**XmlDocument** によって使用されます。ノードを編集するときは、**null** 資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-144">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="8aef0-145">この動作は、**XmlResolver** プロパティが設定されておらず、既定状態のままである場合と同じ動作になります。</span><span class="sxs-lookup"><span data-stu-id="8aef0-145">This behavior is identical to the behavior when the **XmlResolver** property is not set, but left in its default state.</span></span><br /><br /> <span data-ttu-id="8aef0-146">**XmlDocument** では、すべての処理で、匿名のアクセス許可を使用します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-146">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
|<span data-ttu-id="8aef0-147">プロパティが **null** (Microsoft Visual Basic .NET では **Nothing**) に設定されている。</span><span class="sxs-lookup"><span data-stu-id="8aef0-147">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="8aef0-148">外部のスキーマや DTD の検索など、外部リソースを必要とする機能はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-148">No features that require an external resource are supported, such as locating an external schema or DTD.</span></span> <span data-ttu-id="8aef0-149">外部エンティティの解決も行われず、解決が必要なエンティティ ノードの挿入などの編集機能もサポートされません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-149">Nor will external entities be resolved, and performing editing functions such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="8aef0-150">プロパティが **null** の場合の動作は、**XmlDocument** の信頼性の高低に関係なく、同じです。</span><span class="sxs-lookup"><span data-stu-id="8aef0-150">When the property is **null**, the behavior is the same regardless if the **XmlDocument** is fully trusted or semi-trusted.</span></span>|  
|<span data-ttu-id="8aef0-151">プロパティが設定されておらず、既定状態のままである。</span><span class="sxs-lookup"><span data-stu-id="8aef0-151">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="8aef0-152">ファイル名を解決したり、外部の DTD、エンティティ、スキーマを検索するときは、**null** 資格情報を持つ **XmlUrlResolver** のインスタンスが作成され、**XmlDocument** によって使用されます。ノードを編集するときは、**null** 資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-152">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="8aef0-153">**XmlDocument** では、すべての処理で、匿名のアクセス許可を使用します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-153">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
  
 <span data-ttu-id="8aef0-154">**Load** への入力が **XmlReader** であり、**XmlDocument** の信頼性が高くない場合の **XmlDocument.Load** メソッドを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-154">This table applies to the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader**, and the **XmlDocument** is semi-trusted.</span></span>  
  
|<span data-ttu-id="8aef0-155">XmlResolver プロパティ</span><span class="sxs-lookup"><span data-stu-id="8aef0-155">XmlResolver property</span></span>|<span data-ttu-id="8aef0-156">関数</span><span class="sxs-lookup"><span data-stu-id="8aef0-156">Function</span></span>|<span data-ttu-id="8aef0-157">メモ</span><span class="sxs-lookup"><span data-stu-id="8aef0-157">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="8aef0-158">**XmlDocument** で使用される **XmlResolver** クラスが、**XmlReader** で使用されるクラスと同じである。</span><span class="sxs-lookup"><span data-stu-id="8aef0-158">The **XmlResolver** class used by the **XmlDocument** is the same one being used by the **XmlReader**.</span></span>|<span data-ttu-id="8aef0-159">**XmlDocument** は、**XmlReader** に割り当てられた **XmlResolver** を使用します。</span><span class="sxs-lookup"><span data-stu-id="8aef0-159">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="8aef0-160">**XmlReader**  から **XmlResolver** を取得しているため、**XmlDocument** の信頼レベルにかかわらず、**XmlDocument.Resolver** プロパティは設定できません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-160">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="8aef0-161">**XmlDocument** の **XmlResolver** プロパティを設定することによって **XmlReaders** の **XmlResolver** の設定をオーバーライドすることはできません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-161">You cannot attempt to override the settings of the **XmlReaders** **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="8aef0-162">**XmlTextReader**、検証用の <xref:System.Xml.XmlReader>、または独自に作成したリーダーを **XmlTextReader** として使用できます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-162">The **XmlReader** can be the **XmlTextReader**, validating <xref:System.Xml.XmlReader>, or a custom-written reader.</span></span> <span data-ttu-id="8aef0-163">使用するリーダーでエンティティ解決がサポートされている場合は、外部エンティティが解決されます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-163">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="8aef0-164">渡されたリーダーでエンティティ参照がサポートされていない場合は、エンティティ参照は解決されません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-164">If the reader passed in does not support entity references, then entity references are not resolved.</span></span>|  
  
 <span data-ttu-id="8aef0-165">XmlResolver が正しい資格情報を持つように設定すれば、外部リソースにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="8aef0-165">Setting the XmlResolver to contain the correct credentials allows access to external resources.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8aef0-166">**XmlResolver** プロパティを取得する方法はありません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-166">There is no way to retrieve the **XmlResolver** property.</span></span> <span data-ttu-id="8aef0-167">これは、資格情報が設定されている **XmlResolver** をユーザーが再利用するのを防ぐためです。</span><span class="sxs-lookup"><span data-stu-id="8aef0-167">This helps to prevent a user from reusing an **XmlResolver** on which credentials have been set.</span></span> <span data-ttu-id="8aef0-168">また、**XmlTextReader** または検証用の <xref:System.Xml.XmlReader> を使用して、リゾルバーが設定されている **XmlDocument** を読み込んだ場合、**XmlDocument** は、セキュリティ リスクを回避するために、**Load** フェーズの後、これらのリーダーのリゾルバーをキャッシュしません。</span><span class="sxs-lookup"><span data-stu-id="8aef0-168">Also, if an **XmlTextReader** or validating <xref:System.Xml.XmlReader> is used to load the **XmlDocument** and the **XmlDocument** has a resolver that has been set, the resolvers from these readers are not cached by the **XmlDocument** after the **Load** phase, since this also presents a security risk.</span></span>  
  
 <span data-ttu-id="8aef0-169">詳細については、<xref:System.Xml.XmlResolver> のリファレンス ページの「解説」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8aef0-169">For more information, see the Remarks section of the <xref:System.Xml.XmlResolver> reference page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8aef0-170">関連項目</span><span class="sxs-lookup"><span data-stu-id="8aef0-170">See also</span></span>

- [<span data-ttu-id="8aef0-171">XML ドキュメント オブジェクト モデル (DOM)</span><span class="sxs-lookup"><span data-stu-id="8aef0-171">XML Document Object Model (DOM)</span></span>](xml-document-object-model-dom.md)
