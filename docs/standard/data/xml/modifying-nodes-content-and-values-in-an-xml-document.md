---
description: '詳細情報: XML ドキュメントのノード、コンテンツ、値の変更'
title: XML ドキュメントのノード、コンテンツ、値の変更
ms.date: 03/30/2017
ms.assetid: 761773e0-db72-4986-b9f5-a522213d8397
ms.openlocfilehash: 8bf67eb699605ccffdf8a4d2fb7120efa04576a5
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99713495"
---
# <a name="modifying-nodes-content-and-values-in-an-xml-document"></a><span data-ttu-id="ec4c9-103">XML ドキュメントのノード、コンテンツ、値の変更</span><span class="sxs-lookup"><span data-stu-id="ec4c9-103">Modifying Nodes, Content, and Values in an XML Document</span></span>

<span data-ttu-id="ec4c9-104">ドキュメントのノードおよびコンテンツを変更するには、さまざまな方法があります。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-104">There are many ways you can modify the nodes and content in a document.</span></span> <span data-ttu-id="ec4c9-105">次の操作を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-105">You can:</span></span>  
  
- <span data-ttu-id="ec4c9-106"><xref:System.Xml.XmlNode.Value%2A> プロパティを使用してノードの値を変更する。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-106">Change the value of nodes using the <xref:System.Xml.XmlNode.Value%2A> property.</span></span>  
  
- <span data-ttu-id="ec4c9-107">ノードを新しいノードに置き換えることにより、ノード セット全体を変更します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-107">Modify an entire set of nodes by replacing the nodes with new nodes.</span></span> <span data-ttu-id="ec4c9-108">これは <xref:System.Xml.XmlNode.InnerXml%2A> プロパティを使用して実行できます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-108">This is done using the <xref:System.Xml.XmlNode.InnerXml%2A> property.</span></span>  
  
- <span data-ttu-id="ec4c9-109"><xref:System.Xml.XmlNode.RemoveChild%2A> メソッドを使用して既存のノードを新しいノードに置き換える。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-109">Replace existing nodes with new nodes using the <xref:System.Xml.XmlNode.RemoveChild%2A> method.</span></span>  
  
- <span data-ttu-id="ec4c9-110"><xref:System.Xml.XmlCharacterData>、<xref:System.Xml.XmlCharacterData.AppendData%2A>、または <xref:System.Xml.XmlCharacterData.InsertData%2A> メソッドを使用して <xref:System.Xml.XmlCharacterData.ReplaceData%2A> クラスから継承した追加の文字をノードに追加する。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-110">Add additional characters to nodes that inherit from the <xref:System.Xml.XmlCharacterData> class using the <xref:System.Xml.XmlCharacterData.AppendData%2A>, <xref:System.Xml.XmlCharacterData.InsertData%2A>, or <xref:System.Xml.XmlCharacterData.ReplaceData%2A> methods.</span></span>  
  
- <span data-ttu-id="ec4c9-111"><xref:System.Xml.XmlCharacterData.DeleteData%2A> から継承したノード型に対し、<xref:System.Xml.XmlCharacterData> メソッドを使用することにより、文字範囲を削除してコンテンツを変更する。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-111">Modify the content by removing a range of characters using the <xref:System.Xml.XmlCharacterData.DeleteData%2A> method on node types that inherit from <xref:System.Xml.XmlCharacterData>.</span></span>  
  
 <span data-ttu-id="ec4c9-112">ノードの値を簡単に変更するには、`node.Value = "new value";` を使用します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-112">A simple technique for changing the value of a node is to use `node.Value = "new value";`.</span></span> <span data-ttu-id="ec4c9-113">この 1 行のコードを実行できるノード型と、そのノード型で変更されるデータを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-113">The following table lists the node types that this single line of code works on and exactly what data for that node type is changed.</span></span>  
  
|<span data-ttu-id="ec4c9-114">ノード型</span><span class="sxs-lookup"><span data-stu-id="ec4c9-114">Node type</span></span>|<span data-ttu-id="ec4c9-115">変更されるデータ</span><span class="sxs-lookup"><span data-stu-id="ec4c9-115">Data changed</span></span>|  
|---------------|------------------|  
|<span data-ttu-id="ec4c9-116">属性</span><span class="sxs-lookup"><span data-stu-id="ec4c9-116">Attribute</span></span>|<span data-ttu-id="ec4c9-117">属性の値。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-117">The value of the attribute.</span></span>|  
|<span data-ttu-id="ec4c9-118">CDATASection</span><span class="sxs-lookup"><span data-stu-id="ec4c9-118">CDATASection</span></span>|<span data-ttu-id="ec4c9-119">CDATASection のコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-119">The content of the CDATASection.</span></span>|  
|<span data-ttu-id="ec4c9-120">コメント</span><span class="sxs-lookup"><span data-stu-id="ec4c9-120">Comment</span></span>|<span data-ttu-id="ec4c9-121">コメントの内容。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-121">The content of the comment.</span></span>|  
|<span data-ttu-id="ec4c9-122">ProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="ec4c9-122">ProcessingInstruction</span></span>|<span data-ttu-id="ec4c9-123">ターゲットを除くコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-123">The content, excluding the target.</span></span>|  
|<span data-ttu-id="ec4c9-124">テキスト</span><span class="sxs-lookup"><span data-stu-id="ec4c9-124">Text</span></span>|<span data-ttu-id="ec4c9-125">テキストのコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-125">The content of the text.</span></span>|  
|<span data-ttu-id="ec4c9-126">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="ec4c9-126">XmlDeclaration</span></span>|<span data-ttu-id="ec4c9-127">`<?xml` と `?>` のマークアップを除く、宣言のコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-127">The content of the declaration, excluding the `<?xml` and `?>` markup.</span></span>|  
|<span data-ttu-id="ec4c9-128">Whitespace</span><span class="sxs-lookup"><span data-stu-id="ec4c9-128">Whitespace</span></span>|<span data-ttu-id="ec4c9-129">空白の値。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-129">The value of the white space.</span></span> <span data-ttu-id="ec4c9-130">この値は、スペース、タブ、CR、LF という 4 つの認識可能 XML 空白文字のいずれかに設定できます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-130">You can set the value to be one of the four recognized XML white space characters: space, tab, CR, or LF.</span></span>|  
|<span data-ttu-id="ec4c9-131">SignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="ec4c9-131">SignificantWhitespace</span></span>|<span data-ttu-id="ec4c9-132">有意の空白の値。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-132">The value of the significant white space.</span></span> <span data-ttu-id="ec4c9-133">この値は、スペース、タブ、CR、LF という 4 つの認識可能 XML 空白文字のいずれかに設定できます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-133">You can set the value to be one of the four recognized XML white space characters: space, tab, CR, or LF.</span></span>|  
  
 <span data-ttu-id="ec4c9-134">この表に記載されていないノード型は、値を設定できるノード型ではありません。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-134">Any node type not listed in the table is not a valid node type to set a value on.</span></span> <span data-ttu-id="ec4c9-135">これら以外のノード型に値を設定すると、<xref:System.InvalidOperationException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-135">Setting a value on any other node type throws an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="ec4c9-136"><xref:System.Xml.XmlNode.InnerXml%2A> プロパティによって、現在のノードの子ノードのマークアップを変更できます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-136">The <xref:System.Xml.XmlNode.InnerXml%2A> property changes the markup of the child nodes for the current node.</span></span> <span data-ttu-id="ec4c9-137">このプロパティを設定すると、指定した文字列から解析されたコンテンツで子ノードが置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-137">Setting this property replaces the child nodes with the parsed contents of the given string.</span></span> <span data-ttu-id="ec4c9-138">文字列の解析は、現在の名前空間コンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-138">The parsing is done in the current namespace context.</span></span> <span data-ttu-id="ec4c9-139">さらに、<xref:System.Xml.XmlNode.InnerXml%2A> は冗長な名前空間宣言を削除します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-139">In addition, <xref:System.Xml.XmlNode.InnerXml%2A> removes redundant namespace declarations.</span></span> <span data-ttu-id="ec4c9-140">この結果、カット アンド ペースト操作を何度も実行しても、冗長な名前空間宣言によってドキュメント サイズが増加することはありません。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-140">As a result, numerous cut and paste operations do not increase the size of your document with redundant namespace declarations.</span></span> <span data-ttu-id="ec4c9-141"><xref:System.Xml.XmlNode.InnerXml%2A>の操作における名前空間の影響を示すコード サンプルについては、「<xref:System.Xml.XmlDocument.InnerXml%2A>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-141">For a code example showing the effect of namespaces on the <xref:System.Xml.XmlNode.InnerXml%2A> operation, see the <xref:System.Xml.XmlDocument.InnerXml%2A> property.</span></span>  
  
 <span data-ttu-id="ec4c9-142"><xref:System.Xml.XmlCharacterData.ReplaceData%2A> メソッドと <xref:System.Xml.XmlNode.RemoveChild%2A> メソッドを使用すると、これらのメソッドによって置換または削除されたノードが返されます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-142">When using the <xref:System.Xml.XmlCharacterData.ReplaceData%2A> and <xref:System.Xml.XmlNode.RemoveChild%2A> methods, the methods return the replaced or removed node.</span></span> <span data-ttu-id="ec4c9-143">このノードは XML ドキュメント オブジェクト モデル (DOM) のどこかに再度挿入することができます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-143">This node can then be reinserted somewhere else in the XML Document Object Model (DOM).</span></span> <span data-ttu-id="ec4c9-144"><xref:System.Xml.XmlCharacterData.ReplaceData%2A> メソッドは、ドキュメントに挿入されるノードに対し、2 種類の検証チェックを実行します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-144">The <xref:System.Xml.XmlCharacterData.ReplaceData%2A> method does two validation checks on the node being inserted into the document.</span></span> <span data-ttu-id="ec4c9-145">最初のチェックでは、そのノードの親となるノードが、挿入されるノード型の子ノードを持つことができるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-145">The first check ensures that the node is becoming a child of a node that can have child nodes of its type.</span></span> <span data-ttu-id="ec4c9-146">2 番目のチェックでは、挿入されるノードが、その親となるノードの祖先でないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-146">The second check ensures that the node being inserted is not an ancestor of the node it is becoming a child of.</span></span> <span data-ttu-id="ec4c9-147">これらの条件のいずれかに違反すると、<xref:System.InvalidOperationException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-147">Violating either of these conditions throws an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="ec4c9-148">編集可能なノードに読み取り専用の子を追加したり、削除したりするのは有効な操作です。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-148">It is valid to add or remove a read-only child from a node that can be edited.</span></span> <span data-ttu-id="ec4c9-149">しかし、読み取り専用のノードそのものを変更しようとすると、<xref:System.InvalidOperationException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-149">However, attempts to modify the read-only node itself throws an <xref:System.InvalidOperationException>.</span></span> <span data-ttu-id="ec4c9-150">この一例として、<xref:System.Xml.XmlEntityReference> ノードの子を変更しようとした場合が当てはまります。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-150">An example of this is modifying the children of an <xref:System.Xml.XmlEntityReference> node.</span></span> <span data-ttu-id="ec4c9-151">このノードの子は読み取り専用であり、変更できません。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-151">The children are read-only and cannot be modified.</span></span> <span data-ttu-id="ec4c9-152">それらを変更しようとすると、<xref:System.InvalidOperationException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="ec4c9-152">Any attempt to modify them throws an <xref:System.InvalidOperationException>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ec4c9-153">関連項目</span><span class="sxs-lookup"><span data-stu-id="ec4c9-153">See also</span></span>

- [<span data-ttu-id="ec4c9-154">XML ドキュメント オブジェクト モデル (DOM)</span><span class="sxs-lookup"><span data-stu-id="ec4c9-154">XML Document Object Model (DOM)</span></span>](xml-document-object-model-dom.md)
