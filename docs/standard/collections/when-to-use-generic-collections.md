---
description: '詳細情報: ジェネリック コレクションを使用する状況'
title: ジェネリック コレクションを使用する状況
ms.date: 04/30/2020
helpviewer_keywords:
- collections [.NET], generic
- generic collections [.NET]
ms.assetid: e7b868b1-11fe-4ac5-bed3-de68aca47739
ms.openlocfilehash: aea85606044e50c788eee9da4aaf7a4f5934cfc1
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99675989"
---
# <a name="when-to-use-generic-collections"></a><span data-ttu-id="4c3a6-103">ジェネリック コレクションを使用する状況</span><span class="sxs-lookup"><span data-stu-id="4c3a6-103">When to use generic collections</span></span>

<span data-ttu-id="4c3a6-104">ジェネリック コレクションでは、基本コレクション型から派生して型固有のメンバーを実装することなく、タイプ セーフの利点を即座に得ることができます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-104">Using generic collections gives you the automatic benefit of type safety without having to derive from a base collection type and implement type-specific members.</span></span> <span data-ttu-id="4c3a6-105">また、ジェネリックでは要素をボックス化する必要がないため、コレクションの要素が値型である場合、一般的に、ジェネリック コレクション型は、対応する非ジェネリック コレクション型 (および、非ジェネリックの基本コレクション型から派生した型) よりもパフォーマンスに優れています。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-105">Generic collection types also generally perform better than the corresponding nongeneric collection types (and better than types that are derived from nongeneric base collection types) when the collection elements are value types, because with generics, there's no need to box the elements.</span></span>

<span data-ttu-id="4c3a6-106">.NET Standard 1.0 以降を対象にしたプログラムで、複数のスレッドで同時に項目をコレクションに追加またはコレクションから削除する可能性がある場合は、<xref:System.Collections.Concurrent> 名前空間のジェネリック コレクション クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-106">For programs that target .NET Standard 1.0 or later, use the generic collection classes in the <xref:System.Collections.Concurrent> namespace when multiple threads might be adding or removing items from the collection concurrently.</span></span> <span data-ttu-id="4c3a6-107">また、不変にする必要がある場合は、<xref:System.Collections.Immutable> 名前空間のジェネリック コレクション クラスを検討してください。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-107">Additionally, when immutability is desired, consider the generic collection classes in the <xref:System.Collections.Immutable> namespace.</span></span>

<span data-ttu-id="4c3a6-108">次のジェネリック型は、既存のコレクション型に対応しています。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-108">The following generic types correspond to existing collection types:</span></span>

- <span data-ttu-id="4c3a6-109"><xref:System.Collections.Generic.List%601> は、 <xref:System.Collections.ArrayList>に対応するジェネリック クラスです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-109"><xref:System.Collections.Generic.List%601> is the generic class that corresponds to <xref:System.Collections.ArrayList>.</span></span>

- <span data-ttu-id="4c3a6-110"><xref:System.Collections.Generic.Dictionary%602> および <xref:System.Collections.Concurrent.ConcurrentDictionary%602> は、 <xref:System.Collections.Hashtable>に対応するジェネリック クラスです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-110"><xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Concurrent.ConcurrentDictionary%602> are the generic classes that correspond to <xref:System.Collections.Hashtable>.</span></span>

- <span data-ttu-id="4c3a6-111"><xref:System.Collections.ObjectModel.Collection%601> は、 <xref:System.Collections.CollectionBase>に対応するジェネリック クラスです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-111"><xref:System.Collections.ObjectModel.Collection%601> is the generic class that corresponds to <xref:System.Collections.CollectionBase>.</span></span> <span data-ttu-id="4c3a6-112"><xref:System.Collections.ObjectModel.Collection%601> は基本クラスとして使用できますが、<xref:System.Collections.CollectionBase> とは異なり抽象クラスではないので、使いやすいです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-112"><xref:System.Collections.ObjectModel.Collection%601> can be used as a base class, but unlike <xref:System.Collections.CollectionBase>, it is not abstract, which makes it much easier to use.</span></span>

- <span data-ttu-id="4c3a6-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> は、 <xref:System.Collections.ReadOnlyCollectionBase>に対応するジェネリック クラスです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is the generic class that corresponds to <xref:System.Collections.ReadOnlyCollectionBase>.</span></span> <span data-ttu-id="4c3a6-114"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> は抽象クラスではなく、既存の <xref:System.Collections.Generic.List%601> を読み取り専用のコレクションとして簡単に公開できるようにするコンストラクターを含んでいます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-114"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is not abstract and has a constructor that makes it easy to expose an existing <xref:System.Collections.Generic.List%601> as a read-only collection.</span></span>

- <span data-ttu-id="4c3a6-115"><xref:System.Collections.Generic.Queue%601>、<xref:System.Collections.Concurrent.ConcurrentQueue%601>、<xref:System.Collections.Immutable.ImmutableQueue%601>、<xref:System.Collections.Immutable.ImmutableArray%601>、<xref:System.Collections.Generic.SortedList%602> および <xref:System.Collections.Immutable.ImmutableSortedSet%601> ジェネリック クラスは、同じ名前を持つそれぞれの非ジェネリック クラスに対応しています。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-115">The <xref:System.Collections.Generic.Queue%601>, <xref:System.Collections.Concurrent.ConcurrentQueue%601>, <xref:System.Collections.Immutable.ImmutableQueue%601>, <xref:System.Collections.Immutable.ImmutableArray%601>, <xref:System.Collections.Generic.SortedList%602>, and <xref:System.Collections.Immutable.ImmutableSortedSet%601> generic classes correspond to the respective nongeneric classes with the same names.</span></span>

## <a name="additional-types"></a><span data-ttu-id="4c3a6-116">その他の型</span><span class="sxs-lookup"><span data-stu-id="4c3a6-116">Additional Types</span></span>

<span data-ttu-id="4c3a6-117">いくつかのジェネリック コレクション型には、対応する非ジェネリック型がありません。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-117">Several generic collection types do not have nongeneric counterparts.</span></span> <span data-ttu-id="4c3a6-118">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-118">They include the following:</span></span>

- <span data-ttu-id="4c3a6-119"><xref:System.Collections.Generic.LinkedList%601> は、挿入と削除の O(1) 操作を提供する汎用のリンク リストです。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-119"><xref:System.Collections.Generic.LinkedList%601> is a general-purpose linked list that provides O(1) insertion and removal operations.</span></span>

- <span data-ttu-id="4c3a6-120"><xref:System.Collections.Generic.SortedDictionary%602> は、挿入と取得の O(log `n`) 操作で並べ替えられたディクショナリで、 <xref:System.Collections.Generic.SortedList%602>の代替として役立ちます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-120"><xref:System.Collections.Generic.SortedDictionary%602> is a sorted dictionary with O(log `n`) insertion and retrieval operations, which makes it a useful alternative to <xref:System.Collections.Generic.SortedList%602>.</span></span>

- <span data-ttu-id="4c3a6-121"><xref:System.Collections.ObjectModel.KeyedCollection%602> は、リストとディクショナリを組み合わせたもので、独自のキーを含むオブジェクトの格納方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-121"><xref:System.Collections.ObjectModel.KeyedCollection%602> is a hybrid between a list and a dictionary, which provides a way to store objects that contain their own keys.</span></span>

- <span data-ttu-id="4c3a6-122"><xref:System.Collections.Concurrent.BlockingCollection%601> は、境界ブロッキング機能を備えたコレクション クラスを実装します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-122"><xref:System.Collections.Concurrent.BlockingCollection%601> implements a collection class with bounding and blocking functionality.</span></span>

- <span data-ttu-id="4c3a6-123"><xref:System.Collections.Concurrent.ConcurrentBag%601> は、順序のない要素の高速な挿入および削除を提供します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-123"><xref:System.Collections.Concurrent.ConcurrentBag%601> provides fast insertion and removal of unordered elements.</span></span>

### <a name="immutable-builders"></a><span data-ttu-id="4c3a6-124">不変ビルダー</span><span class="sxs-lookup"><span data-stu-id="4c3a6-124">Immutable builders</span></span>

<span data-ttu-id="4c3a6-125"><xref:System.Collections.Immutable> 名前空間には、アプリに不変機能が必要な場合に使用できるジェネリック コレクション型があります。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-125">When you desire immutability functionality in your app, the <xref:System.Collections.Immutable> namespace offers generic collection types you can use.</span></span> <span data-ttu-id="4c3a6-126">すべての不変コレクション型には、複数の変更を実行しているときのパフォーマンスを最適化する `Builder` クラスがあります。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-126">All of the immutable collection types offer `Builder` classes that can optimize performance when you're performing multiple mutations.</span></span> <span data-ttu-id="4c3a6-127">`Builder` クラスは、変更可能な状態の操作をバッチ処理します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-127">The `Builder` class batches operations in a mutable state.</span></span> <span data-ttu-id="4c3a6-128">すべての変更が完了したら、`ToImmutable` メソッドを呼び出してすべてのノードを "凍結" し、<xref:System.Collections.Immutable.ImmutableList%601> などの不変ジェネリック コレクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-128">When all mutations have been completed, call the `ToImmutable` method to "freeze" all nodes and create an immutable generic collection, for example, an <xref:System.Collections.Immutable.ImmutableList%601>.</span></span>

<span data-ttu-id="4c3a6-129">`Builder` オブジェクトは、非ジェネリック `CreateBuilder()` メソッドを呼び出すことによって作成できます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-129">The `Builder` object can be created by calling the nongeneric `CreateBuilder()` method.</span></span> <span data-ttu-id="4c3a6-130">`Builder` インスタンスからは `ToImmutable()` を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-130">From a `Builder` instance, you can call `ToImmutable()`.</span></span> <span data-ttu-id="4c3a6-131">同様に、`Immutable*` コレクションからは `ToBuilder()` を呼び出して、ジェネリック不変コレクションからビルダー インスタンスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-131">Likewise, from the `Immutable*` collection, you can call `ToBuilder()` to create a builder instance from the generic immutable collection.</span></span> <span data-ttu-id="4c3a6-132">`Builder` のさまざまな型を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-132">The following are the various `Builder` types.</span></span>

- <xref:System.Collections.Immutable.ImmutableArray%601.Builder>
- <xref:System.Collections.Immutable.ImmutableDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableHashSet%601.Builder>
- <xref:System.Collections.Immutable.ImmutableList%601.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedSet%601.Builder>

## <a name="linq-to-objects"></a><span data-ttu-id="4c3a6-133">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="4c3a6-133">LINQ to Objects</span></span>

<span data-ttu-id="4c3a6-134">LINQ to Objects 機能では、オブジェクト型が <xref:System.Collections.IEnumerable?displayProperty=nameWithType> インターフェイスまたは <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> インターフェイスを実装している限り、LINQ クエリを使用してメモリ内オブジェクトにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-134">The LINQ to Objects feature enables you to use LINQ queries to access in-memory objects as long as the object type implements the <xref:System.Collections.IEnumerable?displayProperty=nameWithType> or <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> interface.</span></span> <span data-ttu-id="4c3a6-135">LINQ クエリには、データにアクセスする一般的なパターンがあります。通常、これは標準の `foreach` ループよりも簡潔で読みやすく、フィルター処理、並べ替え、およびグループ化機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-135">LINQ queries provide a common pattern for accessing data; are typically more concise and readable than standard `foreach` loops; and provide filtering, ordering, and grouping capabilities.</span></span> <span data-ttu-id="4c3a6-136">さらに、LINQ クエリによってパフォーマンスを向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-136">LINQ queries can also improve performance.</span></span> <span data-ttu-id="4c3a6-137">詳細については、「[LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md)」、「[LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)」、および「[Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-137">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md), [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md), and [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md).</span></span>

## <a name="additional-functionality"></a><span data-ttu-id="4c3a6-138">その他の機能</span><span class="sxs-lookup"><span data-stu-id="4c3a6-138">Additional Functionality</span></span>

<span data-ttu-id="4c3a6-139">一部のジェネリック型には、非ジェネリック コレクション型にはない機能があります。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-139">Some of the generic types have functionality that is not found in the nongeneric collection types.</span></span> <span data-ttu-id="4c3a6-140">たとえば、非ジェネリックの <xref:System.Collections.Generic.List%601> クラスに対応する <xref:System.Collections.ArrayList> クラスには、リストを検索するメソッドを指定できる <xref:System.Predicate%601> デリゲートや、リストの各要素に作用するメソッドを表す <xref:System.Action%601> デリゲートや、型間の変換を定義できるようにする <xref:System.Converter%602> デリゲートなどの、汎用デリゲートを受け取るメソッドが多数あります。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-140">For example, the <xref:System.Collections.Generic.List%601> class, which corresponds to the nongeneric <xref:System.Collections.ArrayList> class, has a number of methods that accept generic delegates, such as the <xref:System.Predicate%601> delegate that allows you to specify methods for searching the list, the <xref:System.Action%601> delegate that represents methods that act on each element of the list, and the <xref:System.Converter%602> delegate that lets you define conversions between types.</span></span>

<span data-ttu-id="4c3a6-141"><xref:System.Collections.Generic.List%601> クラスを使用すると、リストの並べ替えと検索を行う独自の <xref:System.Collections.Generic.IComparer%601> ジェネリック インターフェイス実装を指定できます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-141">The <xref:System.Collections.Generic.List%601> class allows you to specify your own <xref:System.Collections.Generic.IComparer%601> generic interface implementations for sorting and searching the list.</span></span> <span data-ttu-id="4c3a6-142"><xref:System.Collections.Generic.SortedDictionary%602> クラスと <xref:System.Collections.Generic.SortedList%602> クラスにもこの機能があります。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-142">The <xref:System.Collections.Generic.SortedDictionary%602> and <xref:System.Collections.Generic.SortedList%602> classes also have this capability.</span></span> <span data-ttu-id="4c3a6-143">また、これらのクラスを使用すると、コレクションの作成時に比較演算子を指定できます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-143">In addition, these classes let you specify comparers when the collection is created.</span></span> <span data-ttu-id="4c3a6-144">同様に、<xref:System.Collections.Generic.Dictionary%602> クラスと <xref:System.Collections.ObjectModel.KeyedCollection%602> クラスを使用すると、独自の等値比較子を指定できます。</span><span class="sxs-lookup"><span data-stu-id="4c3a6-144">In similar fashion, the <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.ObjectModel.KeyedCollection%602> classes let you specify your own equality comparers.</span></span>

## <a name="see-also"></a><span data-ttu-id="4c3a6-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="4c3a6-145">See also</span></span>

- [<span data-ttu-id="4c3a6-146">コレクションとデータ構造体</span><span class="sxs-lookup"><span data-stu-id="4c3a6-146">Collections and Data Structures</span></span>](index.md)
- [<span data-ttu-id="4c3a6-147"> 一般的に使用されるコレクション型</span><span class="sxs-lookup"><span data-stu-id="4c3a6-147">Commonly Used Collection Types</span></span>](commonly-used-collection-types.md)
- [<span data-ttu-id="4c3a6-148">ジェネリック</span><span class="sxs-lookup"><span data-stu-id="4c3a6-148">Generics</span></span>](../generics/index.md)
