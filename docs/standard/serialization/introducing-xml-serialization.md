---
title: XML シリアル化の詳細
description: シリアル化は転送できる形式にオブジェクトを変換します。 この記事では、XML シリアル化と XmlSerializer クラスの概要について説明します。
ms.date: 12/09/2020
dev_langs:
- csharp
- vb
helpviewer_keywords:
- XML serialization, about XML serialization
- ICollection interface, serializing
- XmlSerializer class, serializing
- serialization, about serialization
- DataSet class, serializing
- XML Schema, serializing
ms.assetid: 8c63200d-db63-4a03-a93d-21641623df62
ms.openlocfilehash: b1b5a90acce55ac7f58c1bde02fee713991dde80
ms.sourcegitcommit: 9b877e160c326577e8aa5ead22a937110d80fa44
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97110157"
---
# <a name="xml-serialization"></a><span data-ttu-id="7be35-104">XML シリアル化</span><span class="sxs-lookup"><span data-stu-id="7be35-104">XML serialization</span></span>

<span data-ttu-id="7be35-105">シリアル化とは、転送できる形式にオブジェクトを変換するプロセスのことです。</span><span class="sxs-lookup"><span data-stu-id="7be35-105">Serialization is the process of converting an object into a form that can be readily transported.</span></span> <span data-ttu-id="7be35-106">たとえば、オブジェクトをシリアル化し、HTTP を使用してインターネット経由でクライアントとサーバー間で転送できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-106">For example, you can serialize an object and transport it over the Internet using HTTP between a client and a server.</span></span> <span data-ttu-id="7be35-107">一方、逆シリアル化とは、ストリームから元のオブジェクトを再構築する処理です。</span><span class="sxs-lookup"><span data-stu-id="7be35-107">On the other end, deserialization reconstructs the object from the stream.</span></span>

 <span data-ttu-id="7be35-108">XML シリアル化では、オブジェクトのパブリック フィールドとプロパティ値のみを XML ストリームにシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="7be35-108">XML serialization serializes only the public fields and property values of an object into an XML stream.</span></span> <span data-ttu-id="7be35-109">型情報は対象に含まれません。</span><span class="sxs-lookup"><span data-stu-id="7be35-109">XML serialization does not include type information.</span></span> <span data-ttu-id="7be35-110">たとえば、**Library** 名前空間に **Book** オブジェクトがある場合、逆シリアル化時に、ストリームから同じ型のオブジェクトが再構築されるという保証はありません。</span><span class="sxs-lookup"><span data-stu-id="7be35-110">For example, if you have a **Book** object that exists in the **Library** namespace, there is no guarantee that it is deserialized into an object of the same type.</span></span>

> [!NOTE]
> <span data-ttu-id="7be35-111">XML シリアル化では、メソッド、インデクサー、プライベート フィールド、または読み取り専用プロパティ (読み取り専用コレクションを除く) は変換されません。</span><span class="sxs-lookup"><span data-stu-id="7be35-111">XML serialization does not convert methods, indexers, private fields, or read-only properties (except read-only collections).</span></span> <span data-ttu-id="7be35-112">オブジェクトのフィールドとプロパティをすべてシリアル化するには、パブリックとプライベートのいずれの場合も、XML シリアル化ではなく、<xref:System.Runtime.Serialization.DataContractSerializer> を使用します。</span><span class="sxs-lookup"><span data-stu-id="7be35-112">To serialize all an object's fields and properties, both public and private, use the <xref:System.Runtime.Serialization.DataContractSerializer> instead of XML serialization.</span></span>

 <span data-ttu-id="7be35-113">XML シリアル化の中核となるクラスは <xref:System.Xml.Serialization.XmlSerializer> クラスです。このクラスの最も重要なメソッドは、**Serialize** メソッドと **Deserialize** メソッドです。</span><span class="sxs-lookup"><span data-stu-id="7be35-113">The central class in XML serialization is the <xref:System.Xml.Serialization.XmlSerializer> class, and the most important methods in this class are the **Serialize** and **Deserialize** methods.</span></span> <span data-ttu-id="7be35-114"><xref:System.Xml.Serialization.XmlSerializer> は、C# ファイルを作成し、これを .dll ファイルにコンパイルすることによってシリアル化を行います。</span><span class="sxs-lookup"><span data-stu-id="7be35-114">The <xref:System.Xml.Serialization.XmlSerializer> creates C# files and compiles them into .dll files to perform this serialization.</span></span> <span data-ttu-id="7be35-115">[XML Serializer Generator Tool (Sgen.exe)](xml-serializer-generator-tool-sgen-exe.md) は、こうしたシリアル化アセンブリがあらかじめ生成されてアプリケーションと共に配置され、起動時のパフォーマンスが向上するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7be35-115">The [XML Serializer Generator Tool (Sgen.exe)](xml-serializer-generator-tool-sgen-exe.md) is designed to generate these serialization assemblies in advance to be deployed with your application and improve startup performance.</span></span> <span data-ttu-id="7be35-116">**XmlSerializer** によって生成される XML ストリームは、World Wide Web コンソーシアム (W3C) による勧告『[XML スキーマ定義言語 (XSD) 1.0](https://www.w3.org/TR/xslt)』に準拠します。</span><span class="sxs-lookup"><span data-stu-id="7be35-116">The XML stream generated by the **XmlSerializer** is compliant with the World Wide Web Consortium (W3C) [XML Schema definition language (XSD) 1.0 recommendation](https://www.w3.org/TR/xslt).</span></span> <span data-ttu-id="7be35-117">さらに、生成されるデータ型は、ドキュメント『XML Schema Part 2:Datatypes』に準拠します。</span><span class="sxs-lookup"><span data-stu-id="7be35-117">Furthermore, the data types generated are compliant with the document titled "XML Schema Part 2: Datatypes."</span></span>

 <span data-ttu-id="7be35-118">オブジェクトのデータは、クラス、フィールド、プロパティ、プリミティブ型、配列などのプログラミング構成要素、および **XmlElement** オブジェクトまたは **XmlAttribute** オブジェクトの形で埋め込まれている XML を使用して記述されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-118">The data in your objects is described using programming language constructs like classes, fields, properties, primitive types, arrays, and even embedded XML in the form of **XmlElement** or **XmlAttribute** objects.</span></span> <span data-ttu-id="7be35-119">属性で注釈を付けて独自のクラスを作成するか、または XML スキーマ定義ツールを使用して、既存の XML スキーマに基づいたクラスを生成できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-119">You have the option of creating your own classes, annotated with attributes, or using the XML Schema Definition tool to generate the classes based on an existing XML Schema.</span></span>

 <span data-ttu-id="7be35-120">XML スキーマがある場合は、XML スキーマ定義ツールを実行して、そのスキーマに厳密に型指定された一連のクラスを生成し、属性を使用して注釈を付けることができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-120">If you have an XML Schema, you can run the XML Schema Definition tool to produce a set of classes that are strongly typed to the schema and annotated with attributes.</span></span> <span data-ttu-id="7be35-121">このようなクラスのインスタンスをシリアル化すると、元の XML スキーマに準拠した XML が生成されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-121">When an instance of such a class is serialized, the generated XML adheres to the XML Schema.</span></span> <span data-ttu-id="7be35-122">このようなクラスを用意することにより、操作が簡単なオブジェクト モデルを使用してプログラミングできると同時に、生成される XML も確実に XML スキーマに準拠したものになります。</span><span class="sxs-lookup"><span data-stu-id="7be35-122">Provided with such a class, you can program against an easily manipulated object model while being assured that the generated XML conforms to the XML schema.</span></span> <span data-ttu-id="7be35-123">.NET の他のクラス (**XmlReader** クラス、**XmlWriter** クラスなど) を使用する代わりに、この方法を使用して XML ストリームの解析や書き込みを実行できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-123">This is an alternative to using other classes in .NET, such as the **XmlReader** and **XmlWriter** classes, to parse and write an XML stream.</span></span> <span data-ttu-id="7be35-124">詳細については、「[XML ドキュメントと XML データ](../data/xml/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-124">For more information, see [XML Documents and Data](../data/xml/index.md).</span></span> <span data-ttu-id="7be35-125">これらのクラスを使用すると、任意の XML ストリームを解析できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-125">These classes allow you to parse any XML stream.</span></span> <span data-ttu-id="7be35-126">これに対し、既知の XML スキーマに準拠した XML ストリームが求められる場合には、**XmlSerializer** を使用します。</span><span class="sxs-lookup"><span data-stu-id="7be35-126">In contrast, use the **XmlSerializer** when the XML stream is expected to conform to a known XML Schema.</span></span>

 <span data-ttu-id="7be35-127">属性を使用して XML ストリームの XML 名前空間、要素名、属性名などを設定することで、**XmlSerializer** クラスによって生成される XML ストリームを制御できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-127">Attributes control the XML stream generated by the **XmlSerializer** class, allowing you to set the XML namespace, element name, attribute name, and so on, of the XML stream.</span></span> <span data-ttu-id="7be35-128">これらの属性、および属性による XML シリアル化の制御方法については、「[属性を使用した XML シリアル化の制御](controlling-xml-serialization-using-attributes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-128">For more information about these attributes and how they control XML serialization, see [Controlling XML Serialization Using Attributes](controlling-xml-serialization-using-attributes.md).</span></span> <span data-ttu-id="7be35-129">また、生成される XML を制御するこれらの属性の一覧については、「[XML シリアル化を制御する属性](attributes-that-control-xml-serialization.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-129">For a table of those attributes that are used to control the generated XML, see [Attributes That Control XML Serialization](attributes-that-control-xml-serialization.md).</span></span>

 <span data-ttu-id="7be35-130">さらに、**XmlSerializer** クラスでは、オブジェクトをシリアル化し、エンコードされた SOAP XML ストリームを生成することができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-130">The **XmlSerializer** class can further serialize an object and generate an encoded SOAP XML stream.</span></span> <span data-ttu-id="7be35-131">このようにして生成される XML は、W3C のドキュメント『Simple Object Access Protocol (SOAP) 1.1』のセクション 5 に準拠します。</span><span class="sxs-lookup"><span data-stu-id="7be35-131">The generated XML adheres to section 5 of the World Wide Web Consortium document titled "Simple Object Access Protocol (SOAP) 1.1."</span></span> <span data-ttu-id="7be35-132">このプロセスの詳細については、「[方法:オブジェクトを SOAP エンコード済み XML ストリームとしてシリアル化する](how-to-serialize-an-object-as-a-soap-encoded-xml-stream.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-132">For more information about this process, see [How to: Serialize an Object as a SOAP-Encoded XML Stream](how-to-serialize-an-object-as-a-soap-encoded-xml-stream.md).</span></span> <span data-ttu-id="7be35-133">生成される XML を制御する属性の一覧については、「[エンコード済み SOAP シリアル化を制御する属性](attributes-that-control-encoded-soap-serialization.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-133">For a table of the attributes that control the generated XML, see [Attributes That Control Encoded SOAP Serialization](attributes-that-control-encoded-soap-serialization.md).</span></span>

 <span data-ttu-id="7be35-134">**XmlSerializer** クラスは、XML Web サービスによって作成され、XML Web サービスに渡される SOAP メッセージを生成します。</span><span class="sxs-lookup"><span data-stu-id="7be35-134">The **XmlSerializer** class generates the SOAP messages created by, and passed to, XML Web services.</span></span> <span data-ttu-id="7be35-135">この SOAP メッセージを制御するには、XML Web サービス ファイル (.asmx) 内のクラス、戻り値、パラメーター、およびフィールドに属性を適用します。</span><span class="sxs-lookup"><span data-stu-id="7be35-135">To control the SOAP messages, you can apply attributes to the classes, return values, parameters, and fields found in an XML Web service file (.asmx).</span></span> <span data-ttu-id="7be35-136">XML Web サービスでは、リテラルまたはエンコード済みのいずれの SOAP スタイルも使用できるため、「XML シリアル化を制御する属性」と「エンコード済み SOAP シリアル化を制御する属性」の両方に示されている属性を使用できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-136">You can use both the attributes listed in "Attributes That Control XML Serialization" and "Attributes That Control Encoded SOAP Serialization" because an XML Web service can use either the literal or encoded SOAP style.</span></span> <span data-ttu-id="7be35-137">XML Web サービスによって生成された XML を属性を使用して制御する方法については、「[XML Web サービスを使用した XML シリアル化](xml-serialization-with-xml-web-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-137">For more information about using attributes to control the XML generated by an XML Web service, see [XML Serialization with XML Web Services](xml-serialization-with-xml-web-services.md).</span></span> <span data-ttu-id="7be35-138">SOAP と XML Web サービスの詳細については、「[SOAP メッセージの書式のカスタマイズ](/previous-versions/dotnet/netframework-4.0/dkwy2d72(v=vs.100))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-138">For more information about SOAP and XML Web services, see [Customizing SOAP Message Formatting](/previous-versions/dotnet/netframework-4.0/dkwy2d72(v=vs.100)).</span></span>

## <a name="security-considerations-for-xmlserializer-applications"></a><span data-ttu-id="7be35-139">XmlSerializer アプリケーションのセキュリティに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="7be35-139">Security Considerations for XmlSerializer Applications</span></span>

<span data-ttu-id="7be35-140">**XmlSerializer** を使用するアプリケーションを作成するときには、次の項目とその関連事項に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-140">When creating an application that uses the **XmlSerializer**, be aware of the following items and their implications:</span></span>

- <span data-ttu-id="7be35-141">**XmlSerializer** は、TEMP 環境変数で指定されたディレクトリ内に C# ファイル (.cs) を作成し、これらを .dll ファイルにコンパイルします。シリアル化はこれらの DLL で行われます。</span><span class="sxs-lookup"><span data-stu-id="7be35-141">The **XmlSerializer** creates C# (.cs) files and compiles them into .dll files in the directory named by the TEMP environment variable; serialization occurs with those DLLs.</span></span>

  > [!NOTE]
  > <span data-ttu-id="7be35-142">SGen.exe ツールを使用すると、このシリアル化アセンブリを事前に生成して署名することができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-142">These serialization assemblies can be generated in advance and signed by using the SGen.exe tool.</span></span> <span data-ttu-id="7be35-143">これは、サーバー側の Web サービスには機能しません。</span><span class="sxs-lookup"><span data-stu-id="7be35-143">This does not work on a server of Web services.</span></span> <span data-ttu-id="7be35-144">クライアント側での手動シリアル化にのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-144">In other words, it is only for client use and for manual serialization.</span></span>

  <span data-ttu-id="7be35-145">作成時とコンパイル時、このコードと DLL には悪意のあるプロセスに対する脆弱性があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-145">The code and the DLLs are vulnerable to a malicious process at the time of creation and compilation.</span></span> <span data-ttu-id="7be35-146">Microsoft Windows NT 4.0 以降を実行しているコンピューターでは、複数のユーザーが一時ディレクトリを共有する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-146">When using a computer running Microsoft Windows NT 4.0 or later, it might be possible for two or more users to share the TEMP directory.</span></span> <span data-ttu-id="7be35-147">2 つのアカウントが異なるセキュリティ特権を持ち、高い特権を持つアカウントが **XmlSerializer** を使用してアプリケーションを実行する場合、一時ディレクトリの共有は危険です。</span><span class="sxs-lookup"><span data-stu-id="7be35-147">Sharing a TEMP directory is dangerous if the two accounts have different security privileges and the higher-privilege account runs an application using the **XmlSerializer**.</span></span> <span data-ttu-id="7be35-148">この場合、一方のユーザーが .cs ファイルまたはコンパイルされた .dll ファイルのいずれかを置き換えることにより、コンピューターのセキュリティが侵害される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-148">In this case, one user can breach the computer's security by replacing either the .cs or .dll file that is compiled.</span></span> <span data-ttu-id="7be35-149">これを防ぐためには、コンピューター上の各アカウントが常に固有のプロファイルを持つようにしてください。</span><span class="sxs-lookup"><span data-stu-id="7be35-149">To eliminate this concern, always be sure that each account on the computer has its own profile.</span></span> <span data-ttu-id="7be35-150">既定では、TEMP 環境変数はアカウントごとに異なるディレクトリを示します。</span><span class="sxs-lookup"><span data-stu-id="7be35-150">By default, the TEMP environment variable points to a different directory for each account.</span></span>

- <span data-ttu-id="7be35-151">悪意のあるユーザーが XML データの連続ストリームを Web サーバーに送り続けた場合 (サービス拒否攻撃)、**XmlSerializer** はコンピューターがリソース不足に陥るまでデータの処理を続行します。</span><span class="sxs-lookup"><span data-stu-id="7be35-151">If a malicious user sends a continuous stream of XML data to a Web server (a denial of service attack), then the **XmlSerializer** continues to process the data until the computer runs low on resources.</span></span>

  <span data-ttu-id="7be35-152">インターネット インフォメーション サービス (IIS) を実行しているコンピューターを使用し、IIS 内でアプリケーションを実行することによって、この種の攻撃を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-152">This kind of attack is eliminated if you are using a computer running Internet Information Services (IIS), and your application is running within IIS.</span></span> <span data-ttu-id="7be35-153">IIS には、一定量 (既定では 4 KB) を超える長さのストリームを処理しないゲート機能があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-153">IIS features a gate that does not process streams longer than a set amount (the default is 4 KB).</span></span> <span data-ttu-id="7be35-154">IIS を使用しないアプリケーションを作成し、**XmlSerializer** による逆シリアル化を行う場合は、同様のゲート機能を実装してサービス拒否攻撃を防ぐ必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-154">If you create an application that does not use IIS and deserializes with the **XmlSerializer**, you should implement a similar gate that prevents a denial of service attack.</span></span>

- <span data-ttu-id="7be35-155">**XmlSerializer** はデータをシリアル化し、指定された任意の型を使用してすべてのコードを実行します。</span><span class="sxs-lookup"><span data-stu-id="7be35-155">The **XmlSerializer** serializes data and runs any code using any type given to it.</span></span>

  <span data-ttu-id="7be35-156">悪意のあるオブジェクトが脅威を与える方法には、次の 2 とおりがあります。</span><span class="sxs-lookup"><span data-stu-id="7be35-156">There are two ways in which a malicious object presents a threat.</span></span> <span data-ttu-id="7be35-157">悪意のあるコードを実行する方法と、**XmlSerializer** によって作成された C# ファイルに悪意のあるコードを挿入する方法です。</span><span class="sxs-lookup"><span data-stu-id="7be35-157">It could run malicious code or it could inject malicious code into the C# file created by the **XmlSerializer**.</span></span> <span data-ttu-id="7be35-158">2 番目のケースでは、**XmlSerializer** によって作成された C# ファイルに、悪意のあるオブジェクトがなんらかの方法でコードを挿入する可能性が論理的にあります。</span><span class="sxs-lookup"><span data-stu-id="7be35-158">In the second case, there is a theoretical possibility that a malicious object may somehow inject code into the C# file created by the **XmlSerializer**.</span></span> <span data-ttu-id="7be35-159">この問題は十分に調査されており、このような攻撃を受ける可能性は低いと考えられますが、不明または信頼されていない型のデータは絶対にシリアル化しないことが重要です。</span><span class="sxs-lookup"><span data-stu-id="7be35-159">Although this issue has been examined thoroughly, and such an attack is considered unlikely, you should take the precaution of never serializing data with an unknown and untrusted type.</span></span>

- <span data-ttu-id="7be35-160">機密情報をシリアル化すると脆弱性が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-160">Serialized sensitive data might be vulnerable.</span></span>

  <span data-ttu-id="7be35-161">**XmlSerializer** がシリアル化したデータは、XML ファイルなどのデータ ストアとして格納されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-161">After the **XmlSerializer** has serialized data, it can be stored as an XML file or other data store.</span></span> <span data-ttu-id="7be35-162">このデータ ストアが他のプロセスからも利用できたり、イントラネットまたはインターネットで表示できたりする場合、データの盗用や悪用の可能性が生じます。</span><span class="sxs-lookup"><span data-stu-id="7be35-162">If your data store is available to other processes, or is visible on an intranet or the Internet, the data can be stolen and used maliciously.</span></span> <span data-ttu-id="7be35-163">たとえば、クレジット カード番号を含む注文をシリアル化するアプリケーションを作成すると、データは非常に脆弱になります。</span><span class="sxs-lookup"><span data-stu-id="7be35-163">For example, if you create an application that serializes orders that include credit card numbers, the data is highly sensitive.</span></span> <span data-ttu-id="7be35-164">これを避けるには、データ ストアを常に保護し、機密を保つための処置が必要です。</span><span class="sxs-lookup"><span data-stu-id="7be35-164">To help prevent this, always protect the store for your data and take steps to keep it private.</span></span>

## <a name="serialization-of-a-simple-class"></a><span data-ttu-id="7be35-165">単純なクラスのシリアル化</span><span class="sxs-lookup"><span data-stu-id="7be35-165">Serialization of a Simple Class</span></span>

<span data-ttu-id="7be35-166">パブリック フィールドを持つ基本クラスのコード例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="7be35-166">The following code example shows a basic class with a public field.</span></span>

```vb
Public Class OrderForm
    Public OrderDate As DateTime
End Class
```

```csharp
public class OrderForm
{
    public DateTime OrderDate;
}
```

<span data-ttu-id="7be35-167">このクラスのインスタンスをシリアル化すると、次のようなストリームが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-167">When an instance of this class is serialized, it might resemble the following.</span></span>

```xml
<OrderForm>
    <OrderDate>12/12/01</OrderDate>
</OrderForm>
```

<span data-ttu-id="7be35-168">シリアル化の例については、「[XML シリアル化の例](examples-of-xml-serialization.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-168">For more examples of serialization, see [Examples of XML Serialization](examples-of-xml-serialization.md).</span></span>

## <a name="items-that-can-be-serialized"></a><span data-ttu-id="7be35-169">シリアル化できる項目</span><span class="sxs-lookup"><span data-stu-id="7be35-169">Items That Can Be Serialized</span></span>

<span data-ttu-id="7be35-170">**XmlSerializer** クラスを使用して、次の項目をシリアル化できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-170">The following items can be serialized using the **XmlSerializer** class:</span></span>

- <span data-ttu-id="7be35-171">パブリックな読み取り/書き込みプロパティとパブリック クラスのフィールド</span><span class="sxs-lookup"><span data-stu-id="7be35-171">Public read/write properties and fields of public classes.</span></span>

- <span data-ttu-id="7be35-172">**ICollection** または **IEnumerable** を実装するクラス。</span><span class="sxs-lookup"><span data-stu-id="7be35-172">Classes that implement **ICollection** or **IEnumerable**.</span></span>

  > [!NOTE]
  > <span data-ttu-id="7be35-173">パブリック プロパティではなく、コレクションのみがシリアル化されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-173">Only collections are serialized, not public properties.</span></span>

- <span data-ttu-id="7be35-174">**XmlElement** オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="7be35-174">**XmlElement** objects.</span></span>

- <span data-ttu-id="7be35-175">**XmlNode** オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="7be35-175">**XmlNode** objects.</span></span>

- <span data-ttu-id="7be35-176">**DataSet** オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="7be35-176">**DataSet** objects.</span></span>

 <span data-ttu-id="7be35-177">オブジェクトのシリアル化と逆シリアル化の詳細については、「[方法:オブジェクトをシリアル化する](how-to-serialize-an-object.md)」および「[方法:オブジェクトを逆シリアル化する](how-to-deserialize-an-object.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-177">For more information about serializing or deserializing objects, see [How to: Serialize an Object](how-to-serialize-an-object.md) and [How to: Deserialize an Object](how-to-deserialize-an-object.md).</span></span>

## <a name="advantages-of-using-xml-serialization"></a><span data-ttu-id="7be35-178">XML シリアル化を使用する利点</span><span class="sxs-lookup"><span data-stu-id="7be35-178">Advantages of Using XML Serialization</span></span>

<span data-ttu-id="7be35-179">**XmlSerializer** クラスを使用すると、オブジェクトを XML としてシリアル化するときに、シリアル化を完全かつ柔軟に制御できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-179">The **XmlSerializer** class gives you complete and flexible control when you serialize an object as XML.</span></span> <span data-ttu-id="7be35-180">XML Web サービスを作成する場合は、シリアル化を制御する属性をクラスやメンバーに適用して、XML 出力を特定のスキーマに準拠させることができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-180">If you are creating an XML Web service, you can apply attributes that control serialization to classes and members to ensure that the XML output conforms to a specific schema.</span></span>

<span data-ttu-id="7be35-181">たとえば、**XmlSerializer** を使用すると、次のことができます。</span><span class="sxs-lookup"><span data-stu-id="7be35-181">For example, **XmlSerializer** enables you to:</span></span>

- <span data-ttu-id="7be35-182">フィールドやプロパティを属性または要素としてエンコードするかどうか</span><span class="sxs-lookup"><span data-stu-id="7be35-182">Specify whether a field or property should be encoded as an attribute or an element.</span></span>

- <span data-ttu-id="7be35-183">使用する XML 名前空間</span><span class="sxs-lookup"><span data-stu-id="7be35-183">Specify an XML namespace to use.</span></span>

- <span data-ttu-id="7be35-184">要素または属性の名前 (フィールド名やプロパティ名が適切ではない場合)</span><span class="sxs-lookup"><span data-stu-id="7be35-184">Specify the name of an element or attribute if a field or property name is inappropriate.</span></span>

<span data-ttu-id="7be35-185">XML シリアル化のもう 1 つの利点は、生成される XML ストリームが特定のスキーマに準拠している限りは、開発するアプリケーションに制約が課されないことです。</span><span class="sxs-lookup"><span data-stu-id="7be35-185">Another advantage of XML serialization is that you have no constraints on the applications you develop, as long as the XML stream that is generated conforms to a given schema.</span></span> <span data-ttu-id="7be35-186">たとえば、書籍の説明に使用するスキーマがあるとします。</span><span class="sxs-lookup"><span data-stu-id="7be35-186">Imagine a schema that is used to describe books.</span></span> <span data-ttu-id="7be35-187">このスキーマでは、書籍名、著者、出版社、ISBN 番号などの要素を扱います。</span><span class="sxs-lookup"><span data-stu-id="7be35-187">It features a title, author, publisher, and ISBN number element.</span></span> <span data-ttu-id="7be35-188">書籍発注や在庫管理など、この XML データを任意の方法で処理するアプリケーションを開発できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-188">You can develop an application that processes the XML data in any way you want, for example, as a book order, or as an inventory of books.</span></span> <span data-ttu-id="7be35-189">いずれの場合も、指定された XML スキーマ定義言語 (XSD) スキーマに XML ストリームが準拠していることが唯一の要件です。</span><span class="sxs-lookup"><span data-stu-id="7be35-189">In either case, the only requirement is that the XML stream conforms to the specified XML Schema definition language (XSD) schema.</span></span>

## <a name="xml-serialization-considerations"></a><span data-ttu-id="7be35-190">XML シリアル化に関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="7be35-190">XML Serialization Considerations</span></span>

<span data-ttu-id="7be35-191">**XmlSerializer** クラスを使用する場合には、次の点を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-191">The following should be considered when using the **XmlSerializer** class:</span></span>

- <span data-ttu-id="7be35-192">Sgen.exe ツールは、特に、シリアル化アセンブリを生成して最適なパフォーマンスを実現するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7be35-192">The Sgen.exe tool is expressly designed to generate serialization assemblies for optimum performance.</span></span>

- <span data-ttu-id="7be35-193">シリアル化されたデータには、データ自体とクラスの構造のみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="7be35-193">The serialized data contains only the data itself and the structure of your classes.</span></span> <span data-ttu-id="7be35-194">型の ID やアセンブリの情報は含まれません。</span><span class="sxs-lookup"><span data-stu-id="7be35-194">Type identity and assembly information are not included.</span></span>

- <span data-ttu-id="7be35-195">シリアル化できるのは、パブリック プロパティとパブリック フィールドのみです。</span><span class="sxs-lookup"><span data-stu-id="7be35-195">Only public properties and fields can be serialized.</span></span> <span data-ttu-id="7be35-196">プロパティにパブリック アクセサー (get メソッドおよび set メソッド) が存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-196">Properties must have public accessors (get and set methods).</span></span> <span data-ttu-id="7be35-197">非パブリック データをシリアル化する必要がある場合は、XML シリアル化ではなく <xref:System.Runtime.Serialization.DataContractSerializer> クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="7be35-197">If you must serialize non-public data, use the <xref:System.Runtime.Serialization.DataContractSerializer> class rather than XML serialization.</span></span>

- <span data-ttu-id="7be35-198">クラスを **XmlSerializer** でシリアル化するには、そのクラスがパラメーターなしのコンストラクターを持つ必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-198">A class must have a parameterless constructor to be serialized by **XmlSerializer**.</span></span>

- <span data-ttu-id="7be35-199">メソッドはシリアル化できません。</span><span class="sxs-lookup"><span data-stu-id="7be35-199">Methods cannot be serialized.</span></span>

- <span data-ttu-id="7be35-200">**IEnumerable** または **ICollection** を異なる方法で実装しているクラスは、次のような特定の要件を満たしていれば、**XmlSerializer** で処理できます。</span><span class="sxs-lookup"><span data-stu-id="7be35-200">**XmlSerializer** can process classes that implement **IEnumerable** or **ICollection** differently if they meet certain requirements, as follows.</span></span>

  <span data-ttu-id="7be35-201">**IEnumerable** を実装するクラスは、単一のパラメーターを受け取るパブリックな **Add** メソッドを実装している必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-201">A class that implements **IEnumerable** must implement a public **Add** method that takes a single parameter.</span></span> <span data-ttu-id="7be35-202">**Add** メソッドのパラメーターは、**GetEnumerator** メソッドによって返される **IEnumerator.Current** プロパティから返される型と一致している (ポリモーフィックである) 必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-202">The **Add** method's parameter must be consistent (polymorphic) with the type returned from the **IEnumerator.Current** property returned from the **GetEnumerator** method.</span></span>

  <span data-ttu-id="7be35-203">**IEnumerable** の他に **ICollection** も実装するクラス (**CollectionBase** など) は、整数を受け取るパブリックなインデックス付き **Item** プロパティ (C# の場合はインデクサー) と、**integer** 型のパブリックな **Count** プロパティを持つ必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-203">A class that implements **ICollection** in addition to **IEnumerable** (such as **CollectionBase**) must have a public **Item** indexed property (an indexer in C#) that takes an integer and it must have a public **Count** property of type **integer**.</span></span> <span data-ttu-id="7be35-204">**Add** メソッドに渡されるパラメーターは、**Item** プロパティから返された型と同じ型か、またはその型の基本型の 1 つである必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-204">The parameter passed to the **Add** method must be the same type as that returned from the **Item** property, or one of that type's bases.</span></span>

  <span data-ttu-id="7be35-205">**ICollection** を実装するクラスの場合、シリアル化される値は、**GetEnumerator** を呼び出して取得されるのではなく、インデックス付き **Item** プロパティから取得されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-205">For classes that implement **ICollection**, values to be serialized are retrieved from the indexed **Item** property rather than by calling **GetEnumerator**.</span></span> <span data-ttu-id="7be35-206">また、パブリック フィールドとパブリック プロパティは、別のコレクション クラス (**ICollection** を実装するクラス) を返すパブリック フィールドを除き、シリアル化されません。</span><span class="sxs-lookup"><span data-stu-id="7be35-206">Also, public fields and properties are not serialized, with the exception of public fields that return another collection class (one that implements **ICollection**).</span></span> <span data-ttu-id="7be35-207">例については、「[XML シリアル化の例](examples-of-xml-serialization.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-207">For an example, see [Examples of XML Serialization](examples-of-xml-serialization.md).</span></span>

## <a name="xsd-data-type-mapping"></a><span data-ttu-id="7be35-208">XSD データ型のマッピング</span><span class="sxs-lookup"><span data-stu-id="7be35-208">XSD Data Type Mapping</span></span>

<span data-ttu-id="7be35-209">W3C のドキュメント『[XML Schema Part 2:Datatypes](https://www.w3.org/TR/xmlschema-2/)』で、XML スキーマ定義言語 (XSD) スキーマで使用できる単純なデータ型が指定されています。</span><span class="sxs-lookup"><span data-stu-id="7be35-209">The W3C document titled [XML Schema Part 2: Datatypes](https://www.w3.org/TR/xmlschema-2/) specifies the simple data types that are allowed in an XML Schema definition language (XSD) schema.</span></span> <span data-ttu-id="7be35-210">これらのデータ型の多く (**int**、**decimal** など) には、対応するデータ型が .NET にあります。</span><span class="sxs-lookup"><span data-stu-id="7be35-210">For many of these (for example, **int** and **decimal**), there is a corresponding data type in .NET.</span></span> <span data-ttu-id="7be35-211">ただし、**NMTOKEN** データ型など、対応する .NET データ型のない XML データ型もあります。</span><span class="sxs-lookup"><span data-stu-id="7be35-211">However, some XML data types do not have a corresponding .NET data type, for example, the **NMTOKEN** data type.</span></span> <span data-ttu-id="7be35-212">その場合、XML スキーマ定義ツール ([XML スキーマ定義ツール (Xsd.exe)](xml-schema-definition-tool-xsd-exe.md)) を使用してスキーマからクラスを生成すると、適切な属性が文字列型のメンバーに適用され、その **DataType** プロパティが XML データ型名に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7be35-212">In such cases, if you use the XML Schema Definition tool ([XML Schema Definition Tool (Xsd.exe)](xml-schema-definition-tool-xsd-exe.md)) to generate classes from a schema, an appropriate attribute is applied to a member of type string, and its **DataType** property is set to the XML data type name.</span></span> <span data-ttu-id="7be35-213">たとえば、XML データ型が **NMTOKEN** である "MyToken" という名前の要素がスキーマに含まれている場合、生成されるクラスには、次の例に示すようなメンバーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="7be35-213">For example, if a schema contains an element named "MyToken" with the XML data type **NMTOKEN**, the generated class might contain a member as shown in the following example.</span></span>

```vb
<XmlElement(DataType:="NMTOKEN")> _
Public MyToken As String
```

```csharp
[XmlElement(DataType = "NMTOKEN")]
public string MyToken;
```

<span data-ttu-id="7be35-214">同様に、特定の XML スキーマ (XSD) に準拠する必要があるクラスを作成する場合は、そのクラスに適切な属性を適用し、**DataType** プロパティを必要な XML データ型名に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7be35-214">Similarly, if you are creating a class that must conform to a specific XML Schema (XSD), you should apply the appropriate attribute and set its **DataType** property to the desired XML data type name.</span></span>

<span data-ttu-id="7be35-215">型のマップの一覧については、次の属性クラスの **DataType** プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7be35-215">For a complete list of type mappings, see the **DataType** property for any of the following attribute classes:</span></span>

- <xref:System.Xml.Serialization.SoapAttributeAttribute>

- <xref:System.Xml.Serialization.SoapElementAttribute>

- <xref:System.Xml.Serialization.XmlArrayItemAttribute>

- <xref:System.Xml.Serialization.XmlAttributeAttribute>

- <xref:System.Xml.Serialization.XmlElementAttribute>

- <xref:System.Xml.Serialization.XmlRootAttribute>

## <a name="see-also"></a><span data-ttu-id="7be35-216">関連項目</span><span class="sxs-lookup"><span data-stu-id="7be35-216">See also</span></span>

- <xref:System.Xml.Serialization.XmlSerializer>
- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.IO.FileStream>
- [<span data-ttu-id="7be35-217">XML シリアル化および SOAP シリアル化</span><span class="sxs-lookup"><span data-stu-id="7be35-217">XML and SOAP Serialization</span></span>](xml-and-soap-serialization.md)
- [<span data-ttu-id="7be35-218">バイナリ シリアル化</span><span class="sxs-lookup"><span data-stu-id="7be35-218">Binary Serialization</span></span>](binary-serialization.md)
- [<span data-ttu-id="7be35-219">シリアル化</span><span class="sxs-lookup"><span data-stu-id="7be35-219">Serialization</span></span>](index.md)
- <xref:System.Xml.Serialization.XmlSerializer>
- [<span data-ttu-id="7be35-220">XML シリアル化の例</span><span class="sxs-lookup"><span data-stu-id="7be35-220">Examples of XML Serialization</span></span>](examples-of-xml-serialization.md)
- [<span data-ttu-id="7be35-221">方法: オブジェクトをシリアル化する</span><span class="sxs-lookup"><span data-stu-id="7be35-221">How to: Serialize an Object</span></span>](how-to-serialize-an-object.md)
- [<span data-ttu-id="7be35-222">方法: オブジェクトを逆シリアル化する</span><span class="sxs-lookup"><span data-stu-id="7be35-222">How to: Deserialize an Object</span></span>](how-to-deserialize-an-object.md)
