---
title: 'CA1502: 複雑にしすぎない (コード分析)'
description: 'コード分析規則「CA1502: 複雑にしすぎない」について'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AvoidExcessiveComplexity
- CA1502
helpviewer_keywords:
- CA1502
- AvoidExcessiveComplexity
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: 86dfcf73070cefc71b7a94ea5f0de385f41d4834
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/30/2021
ms.locfileid: "99777360"
---
# <a name="ca1502-avoid-excessive-complexity"></a><span data-ttu-id="5328a-103">CA1502:メソッドの実装を複雑にしすぎないでください</span><span class="sxs-lookup"><span data-stu-id="5328a-103">CA1502: Avoid excessive complexity</span></span>

| | <span data-ttu-id="5328a-104">値</span><span class="sxs-lookup"><span data-stu-id="5328a-104">Value</span></span> |
|-|-|
| <span data-ttu-id="5328a-105">**ルール ID**</span><span class="sxs-lookup"><span data-stu-id="5328a-105">**Rule ID**</span></span> |<span data-ttu-id="5328a-106">CA1502</span><span class="sxs-lookup"><span data-stu-id="5328a-106">CA1502</span></span>|
| <span data-ttu-id="5328a-107">**カテゴリ**</span><span class="sxs-lookup"><span data-stu-id="5328a-107">**Category**</span></span> |[<span data-ttu-id="5328a-108">保守容易性</span><span class="sxs-lookup"><span data-stu-id="5328a-108">Maintainability</span></span>](maintainability-warnings.md)|
| <span data-ttu-id="5328a-109">**修正が中断か中断なしであるか**</span><span class="sxs-lookup"><span data-stu-id="5328a-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="5328a-110">なし</span><span class="sxs-lookup"><span data-stu-id="5328a-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="5328a-111">原因</span><span class="sxs-lookup"><span data-stu-id="5328a-111">Cause</span></span>

<span data-ttu-id="5328a-112">メソッドに、過剰なサイクロマティック複雑度があります。</span><span class="sxs-lookup"><span data-stu-id="5328a-112">A method has an excessive cyclomatic complexity.</span></span>

## <a name="rule-description"></a><span data-ttu-id="5328a-113">規則の説明</span><span class="sxs-lookup"><span data-stu-id="5328a-113">Rule description</span></span>

<span data-ttu-id="5328a-114">*サイクロマティック複雑度* は、線形独立のメソッド経路数を示す尺度で、条件分岐の数と複雑さによって決まります。</span><span class="sxs-lookup"><span data-stu-id="5328a-114">*Cyclomatic complexity* measures the number of linearly independent paths through the method, which is determined by the number and complexity of conditional branches.</span></span> <span data-ttu-id="5328a-115">サイクロマティック複雑度が低いとは、一般に、そのメソッドが理解しやすく、テストおよび保守が容易であることを示しています。</span><span class="sxs-lookup"><span data-stu-id="5328a-115">A low cyclomatic complexity generally indicates a method that is easy to understand, test, and maintain.</span></span> <span data-ttu-id="5328a-116">サイクロマティック複雑度は、メソッドの制御フロー グラフから計算され、次のように算出されます。</span><span class="sxs-lookup"><span data-stu-id="5328a-116">The cyclomatic complexity is calculated from a control flow graph of the method and is given as follows:</span></span>

<span data-ttu-id="5328a-117">サイクロマティック複雑度 = エッジの数 - ノードの数 + 1</span><span class="sxs-lookup"><span data-stu-id="5328a-117">cyclomatic complexity = the number of edges - the number of nodes + 1</span></span>

<span data-ttu-id="5328a-118">*ノード* はロジックの分岐点を表し、*エッジ* はノード間の線を表します。</span><span class="sxs-lookup"><span data-stu-id="5328a-118">A *node* represents a logic branch point and an *edge* represents a line between nodes.</span></span>

<span data-ttu-id="5328a-119">この規則は、サイクロマティック複雑度が 25 を超える場合に違反を報告します。</span><span class="sxs-lookup"><span data-stu-id="5328a-119">The rule reports a violation when the cyclomatic complexity is more than 25.</span></span>

<span data-ttu-id="5328a-120">コード メトリックの詳細については、[マネージ コードの複雑さの測定](/visualstudio/code-quality/code-metrics-values)に関するページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="5328a-120">You can learn more about code metrics at [Measure complexity of managed code](/visualstudio/code-quality/code-metrics-values).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="5328a-121">違反の修正方法</span><span class="sxs-lookup"><span data-stu-id="5328a-121">How to fix violations</span></span>

<span data-ttu-id="5328a-122">この規則違反を修正するには、メソッドをリファクタリングして、サイクロマティック複雑度を下げます。</span><span class="sxs-lookup"><span data-stu-id="5328a-122">To fix a violation of this rule, refactor the method to reduce its cyclomatic complexity.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="5328a-123">どのようなときに警告を抑制するか</span><span class="sxs-lookup"><span data-stu-id="5328a-123">When to suppress warnings</span></span>

<span data-ttu-id="5328a-124">複雑さを簡単に軽減できない場合、またメソッドが理解しやすく、テストおよび保守が容易に行える場合は、この規則による警告を抑制しても問題ありません。</span><span class="sxs-lookup"><span data-stu-id="5328a-124">It is safe to suppress a warning from this rule if the complexity cannot easily be reduced and the method is easy to understand, test, and maintain.</span></span> <span data-ttu-id="5328a-125">特に、大規模な `switch` (Visual Basic では `Select`) ステートメントを含むメソッドは、除外の候補です。</span><span class="sxs-lookup"><span data-stu-id="5328a-125">In particular, a method that contains a large `switch` (`Select` in Visual Basic) statement is a candidate for exclusion.</span></span> <span data-ttu-id="5328a-126">開発サイクルの後半でコードベースの安定性を損なうリスクがある、または以前に出荷されたコードで実行時の動作に予期しない変更が発生してしまうリスクがあるならば、コードをリファクタリングすることによって保守容易性を向上させるよりも、それらのリスクを避ける方が良い場合があります。</span><span class="sxs-lookup"><span data-stu-id="5328a-126">The risk of destabilizing the code base late in the development cycle or introducing an unexpected change in run-time behavior in previously shipped code might outweigh the maintainability benefits of refactoring the code.</span></span>

## <a name="how-cyclomatic-complexity-is-calculated"></a><span data-ttu-id="5328a-127">サイクロマティック複雑度の計算方法</span><span class="sxs-lookup"><span data-stu-id="5328a-127">How cyclomatic complexity is calculated</span></span>

<span data-ttu-id="5328a-128">サイクロマティック複雑度は、次のように 1 を追加することによって計算されます。</span><span class="sxs-lookup"><span data-stu-id="5328a-128">The cyclomatic complexity is calculated by adding 1 to the following:</span></span>

- <span data-ttu-id="5328a-129">分岐の数 (`if`、`while`、`do` など)</span><span class="sxs-lookup"><span data-stu-id="5328a-129">Number of branches (such as `if`, `while`, and `do`)</span></span>

- <span data-ttu-id="5328a-130">`switch` における `case` ステートメントの数</span><span class="sxs-lookup"><span data-stu-id="5328a-130">Number of `case` statements in a `switch`</span></span>

## <a name="examples"></a><span data-ttu-id="5328a-131">使用例</span><span class="sxs-lookup"><span data-stu-id="5328a-131">Examples</span></span>

<span data-ttu-id="5328a-132">次の例は、さまざまなサイクロマティック複雑度を持つメソッドを示しています。</span><span class="sxs-lookup"><span data-stu-id="5328a-132">The following examples show methods that have varying cyclomatic complexities.</span></span>

### <a name="cyclomatic-complexity-of-1"></a><span data-ttu-id="5328a-133">サイクロマティック複雑度 1</span><span class="sxs-lookup"><span data-stu-id="5328a-133">Cyclomatic complexity of 1</span></span>

```csharp
public void Method()
{
    Console.WriteLine("Hello World!");
}
```

```vb
Public Sub Method()
    Console.WriteLine("Hello World!")
End Sub
```

### <a name="cyclomatic-complexity-of-2"></a><span data-ttu-id="5328a-134">サイクロマティック複雑度 2</span><span class="sxs-lookup"><span data-stu-id="5328a-134">Cyclomatic complexity of 2</span></span>

```csharp
void Method(bool condition)
{
    if (condition)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition As Boolean)
    If (condition) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-3"></a><span data-ttu-id="5328a-135">サイクロマティック複雑度 3</span><span class="sxs-lookup"><span data-stu-id="5328a-135">Cyclomatic complexity of 3</span></span>

```csharp
public void Method(bool condition1, bool condition2)
{
    if (condition1 || condition2)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition1 As Boolean, ByVal condition2 As Boolean)
    If (condition1 OrElse condition2) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-8"></a><span data-ttu-id="5328a-136">サイクロマティック複雑度 8</span><span class="sxs-lookup"><span data-stu-id="5328a-136">Cyclomatic complexity of 8</span></span>

```csharp
public void Method(DayOfWeek day)
{
    switch (day)
    {
        case DayOfWeek.Monday:
            Console.WriteLine("Today is Monday!");
            break;
        case DayOfWeek.Tuesday:
            Console.WriteLine("Today is Tuesday!");
            break;
        case DayOfWeek.Wednesday:
            Console.WriteLine("Today is Wednesday!");
            break;
        case DayOfWeek.Thursday:
            Console.WriteLine("Today is Thursday!");
            break;
        case DayOfWeek.Friday:
            Console.WriteLine("Today is Friday!");
            break;
        case DayOfWeek.Saturday:
            Console.WriteLine("Today is Saturday!");
            break;
        case DayOfWeek.Sunday:
            Console.WriteLine("Today is Sunday!");
            break;
    }
}
```

```vb
Public Sub Method(ByVal day As DayOfWeek)
    Select Case day
        Case DayOfWeek.Monday
            Console.WriteLine("Today is Monday!")
        Case DayOfWeek.Tuesday
            Console.WriteLine("Today is Tuesday!")
        Case DayOfWeek.Wednesday
            Console.WriteLine("Today is Wednesday!")
        Case DayOfWeek.Thursday
            Console.WriteLine("Today is Thursday!")
        Case DayOfWeek.Friday
            Console.WriteLine("Today is Friday!")
        Case DayOfWeek.Saturday
            Console.WriteLine("Today is Saturday!")
        Case DayOfWeek.Sunday
            Console.WriteLine("Today is Sunday!")
    End Select
End Sub
```

## <a name="related-rules"></a><span data-ttu-id="5328a-137">関連規則</span><span class="sxs-lookup"><span data-stu-id="5328a-137">Related rules</span></span>

[<span data-ttu-id="5328a-138">CA1501:継承を使用しすぎないでください</span><span class="sxs-lookup"><span data-stu-id="5328a-138">CA1501: Avoid excessive inheritance</span></span>](ca1501.md)

## <a name="see-also"></a><span data-ttu-id="5328a-139">関連項目</span><span class="sxs-lookup"><span data-stu-id="5328a-139">See also</span></span>

- [<span data-ttu-id="5328a-140">マネージド コードの複雑さと保守性の測定</span><span class="sxs-lookup"><span data-stu-id="5328a-140">Measuring Complexity and Maintainability of Managed Code</span></span>](/visualstudio/code-quality/code-metrics-values)
