---
title: 'CA1401: P/Invoke を参照可能にしない (コード分析)'
description: 'コード分析規則「CA1401: P/Invoke を参照可能にしない」について'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- PInvokesShouldNotBeVisible
- CA1401
helpviewer_keywords:
- CA1401
- PInvokesShouldNotBeVisible
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: f90ca8df32004376873207ee5203f5cb8e0276b2
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/30/2021
ms.locfileid: "99777399"
---
# <a name="ca1401-pinvokes-should-not-be-visible"></a><span data-ttu-id="ad5af-103">CA1401: P/Invoke は参照可能になりません</span><span class="sxs-lookup"><span data-stu-id="ad5af-103">CA1401: P/Invokes should not be visible</span></span>

|                                     | <span data-ttu-id="ad5af-104">値</span><span class="sxs-lookup"><span data-stu-id="ad5af-104">Value</span></span>                      |
|-------------------------------------|----------------------------|
| <span data-ttu-id="ad5af-105">**ルール ID**</span><span class="sxs-lookup"><span data-stu-id="ad5af-105">**Rule ID**</span></span>                          | <span data-ttu-id="ad5af-106">CA1401</span><span class="sxs-lookup"><span data-stu-id="ad5af-106">CA1401</span></span>                     |
| <span data-ttu-id="ad5af-107">**カテゴリ**</span><span class="sxs-lookup"><span data-stu-id="ad5af-107">**Category**</span></span>                        | [<span data-ttu-id="ad5af-108">相互運用性</span><span class="sxs-lookup"><span data-stu-id="ad5af-108">Interoperability</span></span>](interoperability-warnings.md) |
| <span data-ttu-id="ad5af-109">**修正が中断ありか中断なしか**</span><span class="sxs-lookup"><span data-stu-id="ad5af-109">**Fix is breaking or non-breaking**</span></span> | <span data-ttu-id="ad5af-110">あり</span><span class="sxs-lookup"><span data-stu-id="ad5af-110">Breaking</span></span>                   |

## <a name="cause"></a><span data-ttu-id="ad5af-111">原因</span><span class="sxs-lookup"><span data-stu-id="ad5af-111">Cause</span></span>

<span data-ttu-id="ad5af-112">パブリック型のパブリック メソッドまたはプロテクト メソッドに、<xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> 属性があります (Visual Basic では `Declare` キーワードでも実装されます)。</span><span class="sxs-lookup"><span data-stu-id="ad5af-112">A public or protected method in a public type has the <xref:System.Runtime.InteropServices.DllImportAttribute?displayProperty=fullName> attribute (also implemented by the `Declare` keyword in Visual Basic).</span></span>

## <a name="rule-description"></a><span data-ttu-id="ad5af-113">規則の説明</span><span class="sxs-lookup"><span data-stu-id="ad5af-113">Rule description</span></span>

<span data-ttu-id="ad5af-114"><xref:System.Runtime.InteropServices.DllImportAttribute> 属性でマークされているメソッド (または Visual Basic で `Declare` キーワードを使用して定義されているメソッド) がプラットフォーム呼び出しサービスを使用して、アンマネージド コードにアクセスしています。</span><span class="sxs-lookup"><span data-stu-id="ad5af-114">Methods that are marked with the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute (or methods that are defined by using the `Declare` keyword in Visual Basic) use Platform Invocation Services to access unmanaged code.</span></span> <span data-ttu-id="ad5af-115">このようなメソッドは公開しないでください。</span><span class="sxs-lookup"><span data-stu-id="ad5af-115">Such methods should not be exposed.</span></span> <span data-ttu-id="ad5af-116">これらをプライベート メソッドまたは内部メソッドとして保持し、その上で他の方法で呼び出すことができなかったアンマネージ API に呼び出し元がアクセスできるようにすることで、ライブラリを使用したセキュリティ侵害を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="ad5af-116">By keeping these methods private or internal, you make sure that your library cannot be used to breach security by allowing callers access to unmanaged APIs that they could not call otherwise.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="ad5af-117">違反の修正方法</span><span class="sxs-lookup"><span data-stu-id="ad5af-117">How to fix violations</span></span>

<span data-ttu-id="ad5af-118">この規則違反を修正するには、メソッドのアクセス レベルを変更します。</span><span class="sxs-lookup"><span data-stu-id="ad5af-118">To fix a violation of this rule, change the access level of the method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="ad5af-119">どのようなときに警告を抑制するか</span><span class="sxs-lookup"><span data-stu-id="ad5af-119">When to suppress warnings</span></span>

<span data-ttu-id="ad5af-120">この規則による警告は抑制しないでください。</span><span class="sxs-lookup"><span data-stu-id="ad5af-120">Do not suppress a warning from this rule.</span></span>

## <a name="example"></a><span data-ttu-id="ad5af-121">例</span><span class="sxs-lookup"><span data-stu-id="ad5af-121">Example</span></span>

<span data-ttu-id="ad5af-122">次の例では、この規則に違反するメソッドが定義されています。</span><span class="sxs-lookup"><span data-stu-id="ad5af-122">The following example declares a method that violates this rule.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1401.cs" id="snippet1":::

:::code language="vb" source="snippets/vb/all-rules/ca1401-p-invokes-should-not-be-visible_1.vb":::
