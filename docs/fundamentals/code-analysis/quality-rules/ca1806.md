---
title: 'CA1806: メソッドの結果を無視しない (コード分析)'
description: 'コード分析規則「CA1806: メソッドの結果を無視しない」について'
ms.date: 06/08/2020
ms.topic: reference
f1_keywords:
- CA1806
- DoNotIgnoreMethodResults
helpviewer_keywords:
- CA1806
- DoNotIgnoreMethodResults
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: c5a132697eaeeb7e0ce70a69099d0c0085f1187d
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/30/2021
ms.locfileid: "99776905"
---
# <a name="ca1806-do-not-ignore-method-results"></a><span data-ttu-id="290ee-103">CA1806:メソッドの結果を無視しない</span><span class="sxs-lookup"><span data-stu-id="290ee-103">CA1806: Do not ignore method results</span></span>

| | <span data-ttu-id="290ee-104">値</span><span class="sxs-lookup"><span data-stu-id="290ee-104">Value</span></span> |
|-|-|
| <span data-ttu-id="290ee-105">**ルール ID**</span><span class="sxs-lookup"><span data-stu-id="290ee-105">**Rule ID**</span></span> |<span data-ttu-id="290ee-106">CA1806</span><span class="sxs-lookup"><span data-stu-id="290ee-106">CA1806</span></span>|
| <span data-ttu-id="290ee-107">**カテゴリ**</span><span class="sxs-lookup"><span data-stu-id="290ee-107">**Category**</span></span> |[<span data-ttu-id="290ee-108">使用方法</span><span class="sxs-lookup"><span data-stu-id="290ee-108">Usage</span></span>](usage-warnings.md)|
| <span data-ttu-id="290ee-109">**修正が中断ありか中断なしか**</span><span class="sxs-lookup"><span data-stu-id="290ee-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="290ee-110">なし</span><span class="sxs-lookup"><span data-stu-id="290ee-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="290ee-111">原因</span><span class="sxs-lookup"><span data-stu-id="290ee-111">Cause</span></span>

<span data-ttu-id="290ee-112">この警告の原因はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="290ee-112">There are several possible reasons for this warning:</span></span>

- <span data-ttu-id="290ee-113">新しいオブジェクトが作成されましたが、使用されませんでした。</span><span class="sxs-lookup"><span data-stu-id="290ee-113">A new object is created but never used.</span></span>

- <span data-ttu-id="290ee-114">新しい文字列を作成して返すメソッドが呼び出され、新しい文字列が使用されていません。</span><span class="sxs-lookup"><span data-stu-id="290ee-114">A method that creates and returns a new string is called and the new string is never used.</span></span>

- <span data-ttu-id="290ee-115">使用されない `HRESULT` またはエラー コードを返す COM メソッドまたは P/Invoke メソッド。</span><span class="sxs-lookup"><span data-stu-id="290ee-115">A COM or P/Invoke method that returns a `HRESULT` or error code that is never used.</span></span>

- <span data-ttu-id="290ee-116">使用されない結果を返す統合言語クエリ (LINQ) メソッド。</span><span class="sxs-lookup"><span data-stu-id="290ee-116">A language-integrated query (LINQ) method that returns a result that is never used.</span></span>

## <a name="rule-description"></a><span data-ttu-id="290ee-117">規則の説明</span><span class="sxs-lookup"><span data-stu-id="290ee-117">Rule description</span></span>

<span data-ttu-id="290ee-118">不要なオブジェクトの作成と、使用されないオブジェクトに関連するガベージ コレクションにより、パフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="290ee-118">Unnecessary object creation and the associated garbage collection of the unused object degrade performance.</span></span>

<span data-ttu-id="290ee-119">文字列は不変であり、String.ToUpper などのメソッドは、呼び出し元のメソッド内の文字列のインスタンスを変更するのではなく、文字列の新しいインスタンスを返します。</span><span class="sxs-lookup"><span data-stu-id="290ee-119">Strings are immutable and methods such as String.ToUpper returns a new instance of a string instead of modifying the instance of the string in the calling method.</span></span>

<span data-ttu-id="290ee-120">`HRESULT` またはエラー コードを無視すると、エラー状態やリソース不足の状態で予期しない動作が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="290ee-120">Ignoring `HRESULT` or error code can lead to unexpected behavior in error conditions or to low-resource conditions.</span></span>

<span data-ttu-id="290ee-121">LINQ メソッドは副作用がないことがわかっているため、結果を無視するべきではありません。</span><span class="sxs-lookup"><span data-stu-id="290ee-121">LINQ methods are known to not have side effects, and the result should not be ignored.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="290ee-122">違反の修正方法</span><span class="sxs-lookup"><span data-stu-id="290ee-122">How to fix violations</span></span>

<span data-ttu-id="290ee-123">メソッド A が使用しない B オブジェクトの新しいインスタンスを作成する場合は、インスタンスを引数として別のメソッドに渡すか、変数にインスタンスを代入します。</span><span class="sxs-lookup"><span data-stu-id="290ee-123">If method A creates a new instance of B object that is never used, pass the instance as an argument to another method or assign the instance to a variable.</span></span> <span data-ttu-id="290ee-124">オブジェクトの作成が不要な場合は、オブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="290ee-124">If the object creation is unnecessary, remove the it.</span></span>

<span data-ttu-id="290ee-125">\- または -</span><span class="sxs-lookup"><span data-stu-id="290ee-125">-or-</span></span>

<span data-ttu-id="290ee-126">メソッド A がメソッド B を呼び出すにもかかわらず、メソッド B から返される新しい文字列インスタンスを使用しない場合は、インスタンスを引数として他のメソッドに渡すか、変数にインスタンスを割り当てます。</span><span class="sxs-lookup"><span data-stu-id="290ee-126">If method A calls method B, but does not use the new string instance that the method B returns, pass the instance as an argument to another method, assign the instance to a variable.</span></span> <span data-ttu-id="290ee-127">または、不要な場合には呼び出しを削除します。</span><span class="sxs-lookup"><span data-stu-id="290ee-127">Or remove the call if it is unnecessary.</span></span>

<span data-ttu-id="290ee-128">\- または -</span><span class="sxs-lookup"><span data-stu-id="290ee-128">-or-</span></span>

<span data-ttu-id="290ee-129">メソッド A がメソッド B を呼び出すにもかかわらず、メソッドから返される `HRESULT` またはエラー コードを使用しない場合は、条件ステートメントで結果を使用するか、変数に結果を割り当てるか、引数として他のメソッドに渡します。</span><span class="sxs-lookup"><span data-stu-id="290ee-129">If method A calls method B, but does not use the `HRESULT` or error code that the method returns, use the result in a conditional statement, assign the result to a variable, or pass it as an argument to another method.</span></span>

<span data-ttu-id="290ee-130">\- または -</span><span class="sxs-lookup"><span data-stu-id="290ee-130">-or-</span></span>

<span data-ttu-id="290ee-131">LINQ メソッド A がメソッド B を呼び出すにもかかわらず、結果を使用しない場合は、条件ステートメントで結果を使用するか、変数に結果を割り当てるか、引数として他のメソッドに渡します。</span><span class="sxs-lookup"><span data-stu-id="290ee-131">If a LINQ method A calls method B, but does not use the result, use the result in a conditional statement, assign the result to a variable, or pass it as an argument to another method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="290ee-132">どのようなときに警告を抑制するか</span><span class="sxs-lookup"><span data-stu-id="290ee-132">When to suppress warnings</span></span>

<span data-ttu-id="290ee-133">オブジェクトを作成する操作によって何らかの目的がある場合を除き、この規則による警告を抑制しないでください。</span><span class="sxs-lookup"><span data-stu-id="290ee-133">Do not suppress a warning from this rule unless the act of creating the object serves some purpose.</span></span>

## <a name="example-1"></a><span data-ttu-id="290ee-134">例 1</span><span class="sxs-lookup"><span data-stu-id="290ee-134">Example 1</span></span>

<span data-ttu-id="290ee-135">次の例は、String.Trim の呼び出し結果を無視するクラスを示しています。</span><span class="sxs-lookup"><span data-stu-id="290ee-135">The following example shows a class that ignores the result of calling String.Trim.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1806.cs" id="snippet1":::

:::code language="vb" source="snippets/vb/all-rules/ca1806-do-not-ignore-method-results_1.vb" id="snippet1":::

## <a name="example-2"></a><span data-ttu-id="290ee-136">例 2</span><span class="sxs-lookup"><span data-stu-id="290ee-136">Example 2</span></span>

<span data-ttu-id="290ee-137">次の例では、呼び出し元の変数に String.Trim の結果を代入することで、前の違反を修正しました。</span><span class="sxs-lookup"><span data-stu-id="290ee-137">The following example fixes the previous violation by assigning the result of String.Trim back to the variable it was called on.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1806.cs" id="snippet2":::

:::code language="vb" source="snippets/vb/all-rules/ca1806-do-not-ignore-method-results_1.vb" id="snippet2":::

## <a name="example-3"></a><span data-ttu-id="290ee-138">例 3</span><span class="sxs-lookup"><span data-stu-id="290ee-138">Example 3</span></span>

<span data-ttu-id="290ee-139">次の例は、作成したオブジェクトを使用しないメソッドを示しています。</span><span class="sxs-lookup"><span data-stu-id="290ee-139">The following example shows a method that does not use an object that it creates.</span></span>

> [!NOTE]
> <span data-ttu-id="290ee-140">Visual Basic でこの違反を再現することはできません。</span><span class="sxs-lookup"><span data-stu-id="290ee-140">This violation cannot be reproduced in Visual Basic.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1806.cs" id="snippet3":::

## <a name="example-4"></a><span data-ttu-id="290ee-141">例 4</span><span class="sxs-lookup"><span data-stu-id="290ee-141">Example 4</span></span>

<span data-ttu-id="290ee-142">次の例では、不要なオブジェクトの作成を削除することによって、前の違反を修正します。</span><span class="sxs-lookup"><span data-stu-id="290ee-142">The following example fixes the previous violation by removing the unnecessary creation of an object.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1806.cs" id="snippet4":::

<!-- Examples don't exist for the following...

The following example shows a method that ignores the error code that the native method GetShortPathName returns.

The following example fixes the previous violation by checking the error code and throwing an exception when the call fails.
-->
