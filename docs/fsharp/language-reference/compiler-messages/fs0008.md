---
description: '詳細情報: FS0008: 不確定な実行時の強制型変換'
title: コンパイラ エラー FS0008
ms.date: 01/27/2020
f1_keywords:
- FS0008
helpviewer_keywords:
- FS0008
ms.openlocfilehash: aa7ab1f3a62e43088d34f69a24bbb03caddf2196
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99631021"
---
# <a name="fs0008-indeterminate-runtime-coercion"></a><span data-ttu-id="3a7f4-103">FS0008: 不確定な実行時の強制型変換</span><span class="sxs-lookup"><span data-stu-id="3a7f4-103">FS0008: Indeterminate runtime coercion</span></span>

<span data-ttu-id="3a7f4-104">このメッセージは、型テスト パターンを使用して値を照合するものの、型の値がコンパイラによって決定されていないため、コンパイル時にキャストの安全性を証明できない場合に出されます。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-104">This message is given when a type-test pattern is used to match a value, but the cast cannot be safely proven at compile time because the type value has not been determined by the compiler.</span></span> <span data-ttu-id="3a7f4-105">これは多くの場合、型が推論された関数パラメーターでのマッチングで発生します。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-105">This often happens when matching on a function parameter whose type has been inferred.</span></span>  <span data-ttu-id="3a7f4-106">次のコードは、この例を示しています。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-106">The following code illustrates an example of this:</span></span>

[!code-fsharp[FS0008-error](~/samples/snippets/fsharp/compiler-messages/fs0008.fsx#L2-L5)]

<span data-ttu-id="3a7f4-107">このコードの結果は、次のような出力です。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-107">This code results in the following output:</span></span>

```text
This runtime coercion or type test from type
    'a
to
    string
involves an indeterminate type based on information prior to this program point. Runtime type tests are not allowed on some types. Further type annotations are needed.
```

<span data-ttu-id="3a7f4-108">このコードでは、関数パラメーター `x` の型は推論されたものではありません。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-108">In this code, the function parameter `x` has not had a type inferred for it.</span></span> <span data-ttu-id="3a7f4-109">その理由としては、パラメーターの使用方法のために型推論アルゴリズムに情報が提供されないことから、この関数がコード内の他の場所で呼び出されていないことまで、さまざまなことが考えられます。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-109">This could be for any number of reasons, ranging from the parameter not being used in ways that give the type-inference algorithm any information, to the function not being called anywhere else in the code.</span></span>  <span data-ttu-id="3a7f4-110">`x` の型が推論されたものではないため、コンパイラでは `x` の型を文字列としてキャストできるかどうかを保証できません。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-110">Because the type of `x` has not been inferred, the compiler cannot guarantee that the type of `x` is able to be cast as a string.</span></span>  <span data-ttu-id="3a7f4-111">コンパイラでは実行時にこのキャストを実行できるかどうかを保証できないため、このメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-111">Because the compiler cannot guarantee that this cast is able to be performed at runtime, it gives this message.</span></span>

<span data-ttu-id="3a7f4-112">このメッセージを修正するには、型テスト パターンを使用している値の型に関する詳細情報をコンパイラに提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-112">To fix this message you must provide the compiler more information about the type of the value for which you are using the type-test pattern.</span></span>

<span data-ttu-id="3a7f4-113">上記のコードを修正する方法の 1 つは、型を `x` パラメーターに直接適用することです。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-113">One way of fixing the above code would be to apply a type to the `x` parameter directly:</span></span>

[!code-fsharp[FS0008-x-given-type](~/samples/snippets/fsharp/compiler-messages/fs0008.fsx#L8-L11)]

<span data-ttu-id="3a7f4-114">上記のコードでは、`x` パラメーターに `obj` の型が指定されています。`obj` に対して型のテストを行って、基になる表現が `string` であるかどうかを確認できるため、この関数はコンパイルされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-114">In this code, the `x` parameter is given a type of `obj`, and since `obj` is able to be type-tested to see if the underlying representation is `string`, the function now compiles.</span></span>

<span data-ttu-id="3a7f4-115">この間違ったコードを修正するもう 1 つの方法は、`x` パラメーターを `string` に変換する他の方法を使用することです。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-115">Another way of fixing the erroneous code is to use a different way of converting the `x` parameter to a `string`:</span></span>

[!code-fsharp[FS0008-x-given-type](~/samples/snippets/fsharp/compiler-messages/fs0008.fsx#L14-L15)]

<span data-ttu-id="3a7f4-116">上記のコードでは、`string` パラメーターに対して `x` 関数を使用することにより、`x` の型を `string` として推論するのに十分な情報がコンパイラに与えられているため、関数のリファクタリングによってエラーが解決されます。</span><span class="sxs-lookup"><span data-stu-id="3a7f4-116">In this code, the use of the `string` function on the `x` parameter has given the compiler enough information to infer the type of `x` as `string`, so the error is resolved by refactoring the function.</span></span>
