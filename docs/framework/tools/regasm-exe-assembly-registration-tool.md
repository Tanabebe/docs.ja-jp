---
title: Regasm.exe (アセンブリ登録ツール)
description: Regasm.exe (アセンブリ登録ツール) を使用します。 アセンブリ メタデータを読み取り、必要なエントリをレジストリに追加します。これにより、COM クライアントによる .NET クラスの作成が許可されます。
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
ms.openlocfilehash: 14dbaf0e100204718e78292b038bf016b5607bc8
ms.sourcegitcommit: 9c589b25b005b9a7f87327646020eb85c3b6306f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2021
ms.locfileid: "102259191"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="a9a11-104">Regasm.exe (アセンブリ登録ツール)</span><span class="sxs-lookup"><span data-stu-id="a9a11-104">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="a9a11-105">アセンブリ登録ツールは、1 つのアセンブリに含まれるメタデータを読み込み、必要なエントリをレジストリに追加します。これにより、COM クライアントによって .NET Framework クラスが自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-105">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="a9a11-106">クラスが登録されると、どの COM クライアントでも、そのクラスを COM クラスであるかのように使用できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-106">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="a9a11-107">クラスの登録は、アセンブリのインストール時に 1 回だけ行われます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-107">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="a9a11-108">実際に登録されるまでは、アセンブリに含まれるクラスのインスタンスを COM から作成することはできません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-108">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="a9a11-109">ツールを実行するには、[開発者コマンドライン シェル](/visualstudio/ide/reference/command-prompt-powershell)を使用します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-109">To run the tool, use a [developer command-line shell](/visualstudio/ide/reference/command-prompt-powershell).</span></span>

<span data-ttu-id="a9a11-110">コマンド プロンプトに次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-110">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="a9a11-111">構文</span><span class="sxs-lookup"><span data-stu-id="a9a11-111">Syntax</span></span>

```console
regasm assemblyFile [options]
```

## <a name="parameters"></a><span data-ttu-id="a9a11-112">パラメーター</span><span class="sxs-lookup"><span data-stu-id="a9a11-112">Parameters</span></span>

|<span data-ttu-id="a9a11-113">パラメーター</span><span class="sxs-lookup"><span data-stu-id="a9a11-113">Parameter</span></span>|<span data-ttu-id="a9a11-114">説明</span><span class="sxs-lookup"><span data-stu-id="a9a11-114">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="a9a11-115">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="a9a11-115">*assemblyFile*</span></span>|<span data-ttu-id="a9a11-116">COM に登録するアセンブリ。</span><span class="sxs-lookup"><span data-stu-id="a9a11-116">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="a9a11-117">オプション</span><span class="sxs-lookup"><span data-stu-id="a9a11-117">Option</span></span>|<span data-ttu-id="a9a11-118">説明</span><span class="sxs-lookup"><span data-stu-id="a9a11-118">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="a9a11-119">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="a9a11-119">**/codebase**</span></span>|<span data-ttu-id="a9a11-120">レジストリに Codebase エントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-120">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="a9a11-121">Codebase エントリによって、グローバル アセンブリ キャッシュにインストールされないアセンブリのファイル パスが指定されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-121">The Codebase entry specifies the file path for an assembly that's not installed in the global assembly cache.</span></span> <span data-ttu-id="a9a11-122">登録しようとしているアセンブリを、後でグローバル アセンブリ キャッシュにインストールする場合は、このオプションを指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="a9a11-122">Don't specify this option if you will subsequently install the assembly that you're registering into the global assembly cache.</span></span> <span data-ttu-id="a9a11-123">**/codebase** オプションと共に指定する *assemblyFile* 引数は、[厳密な名前付きのアセンブリ](../../standard/assembly/strong-named.md)である必要があります。</span><span class="sxs-lookup"><span data-stu-id="a9a11-123">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../standard/assembly/strong-named.md).</span></span>|
|<span data-ttu-id="a9a11-124">**/registered**</span><span class="sxs-lookup"><span data-stu-id="a9a11-124">**/registered**</span></span>|<span data-ttu-id="a9a11-125">このツールが既に登録されているタイプ ライブラリだけを参照するように指定します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-125">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="a9a11-126">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="a9a11-126">**/asmpath:directory**</span></span>|<span data-ttu-id="a9a11-127">アセンブリ参照を含むディレクトリを指定します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-127">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="a9a11-128">**/regfile** オプションと共に使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a9a11-128">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="a9a11-129">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="a9a11-129">**/nologo**</span></span>|<span data-ttu-id="a9a11-130">Microsoft 著作権情報を表示しません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-130">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="a9a11-131">**/regfile** [ **:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="a9a11-131">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="a9a11-132">アセンブリについて指定した .reg ファイルを生成します。このファイルには必要なレジストリ エントリが含まれます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-132">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="a9a11-133">このオプションを指定してもレジストリは変更されません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-133">Specifying this option does not change the registry.</span></span> <span data-ttu-id="a9a11-134">このオプションは **/u** または **/tlb** オプションとは併用できません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-134">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="a9a11-135">**/silent** または **/s**</span><span class="sxs-lookup"><span data-stu-id="a9a11-135">**/silent** or **/s**</span></span>|<span data-ttu-id="a9a11-136">成功メッセージを表示しません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-136">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="a9a11-137">**/tlb** [ **:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="a9a11-137">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="a9a11-138">指定したアセンブリからタイプ ライブラリを生成します。このアセンブリには、アセンブリ内で定義されたアクセス可能な型の定義が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-138">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="a9a11-139">**/unregister** または **/u**</span><span class="sxs-lookup"><span data-stu-id="a9a11-139">**/unregister** or **/u**</span></span>|<span data-ttu-id="a9a11-140">*assemblyFile* 内で見つかった、作成可能なクラスの登録を取り消します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-140">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="a9a11-141">このオプションを省略すると、アセンブリ内の作成可能なクラスが Regasm.exe で登録されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-141">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="a9a11-142">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="a9a11-142">**/verbose**</span></span>|<span data-ttu-id="a9a11-143">詳細出力モードを指定します。 **/tlb** オプションと共に指定した場合、タイプ ライブラリを生成する必要のある参照先アセンブリの一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-143">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="a9a11-144">**/?**</span><span class="sxs-lookup"><span data-stu-id="a9a11-144">**/?**</span></span> <span data-ttu-id="a9a11-145">または **/help**</span><span class="sxs-lookup"><span data-stu-id="a9a11-145">or **/help**</span></span>|<span data-ttu-id="a9a11-146">このツールのコマンド構文とオプションを表示します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-146">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="a9a11-147">Regasm.exe のコマンド行オプションでは大文字と小文字が区別されません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-147">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="a9a11-148">オプションの一部を指定するだけで一意に識別できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-148">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="a9a11-149">たとえば、 **/n** は **/nologo** と等価であり、 **/t:** *outfile.tlb* は **/tlb:** *outfile.tlb* と等価です。</span><span class="sxs-lookup"><span data-stu-id="a9a11-149">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="a9a11-150">Remarks</span><span class="sxs-lookup"><span data-stu-id="a9a11-150">Remarks</span></span>

<span data-ttu-id="a9a11-151">**/regfile** オプションを使用すると、直接にレジストリを変更しなくても、レジストリ エントリを含む .reg ファイルを生成できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-151">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="a9a11-152">コンピューターのレジストリを更新するには、レジストリ エディター ツール (Regedit.exe) を使用して .reg ファイルをインポートします。</span><span class="sxs-lookup"><span data-stu-id="a9a11-152">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="a9a11-153">.reg ファイルには、ユーザー定義の登録機能で行われる可能性があるレジストリの更新は含まれません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-153">The .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span> <span data-ttu-id="a9a11-154">**/regfile** オプションは、マネージド クラスのレジストリ エントリだけを生成します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-154">The **/regfile** option only emits registry entries for managed classes.</span></span> <span data-ttu-id="a9a11-155">このオプションは、`TypeLibID` と `InterfaceID` のエントリは生成しません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-155">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="a9a11-156">**/tlb** オプションを指定すると、アセンブリ内で見つかった型を記述するタイプ ライブラリが Regasm.exe で生成および登録されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-156">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="a9a11-157">生成されたタイプ ライブラリは、現在の作業ディレクトリ、または出力ファイル用に指定されたディレクトリ内に格納されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-157">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="a9a11-158">他のアセンブリを参照するアセンブリについてタイプ ライブラリを生成すると、一度に複数のタイプ ライブラリが生成されることがあります。</span><span class="sxs-lookup"><span data-stu-id="a9a11-158">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="a9a11-159">タイプ ライブラリを使用して、Visual Studio などの開発用ツールに対して型情報を提供できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-159">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="a9a11-160">登録するアセンブリがタイプ ライブラリ インポーター ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)) で生成されたアセンブリである場合には、 **/tlb** オプションを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="a9a11-160">Don't use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="a9a11-161">タイプ ライブラリからインポートされたアセンブリからは、タイプ ライブラリをエクスポートできません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-161">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="a9a11-162">**/tlb** オプションを使用した場合の効果は、タイプ ライブラリ エクスポーター ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) と Regasm.exe を使用した場合と同じです。ただし、Tlbexp.exe では、生成されたタイプ ライブラリが登録されません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-162">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="a9a11-163">**/tlb** オプションを使用してタイプ ライブラリを登録する場合、 **/tlb** オプションと **/unregister** オプションを使用してタイプ ライブラリの登録を解除できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-163">If you use the **/tlb** option to register a type library, you can use the **/tlb** option with the **/unregister** option to unregister the type library.</span></span> <span data-ttu-id="a9a11-164">この 2 つのオプションを使用すると、タイプ ライブラリとインターフェイス エントリの登録を解除でき、これによって、レジストリをかなり整理できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-164">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="a9a11-165">COM で使用するためにアセンブリを登録すると、Regasm.exe は、ローカル コンピューターのレジストリにエントリを追加します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-165">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="a9a11-166">より具体的には、バージョンに依存するレジストリ キーを作成して、同じアセンブリの複数のバージョンが同じコンピューターで side-by-side 実行できるようにします。</span><span class="sxs-lookup"><span data-stu-id="a9a11-166">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="a9a11-167">アセンブリが初めて登録される場合は、そのアセンブリの最上位キーが 1 つ作成され、特定のバージョンに対する一意なサブキーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-167">The first time an assembly is registered, one top-level key is created for the assembly, and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="a9a11-168">アセンブリの新しいバージョンを登録するたびに、Regasm.exe は、新しいバージョンに対するサブキーを作成します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-168">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="a9a11-169">たとえば、COM で使用するために、マネージド コンポーネント myComp.dll のバージョン 1.0.0.0 を登録しているとします。</span><span class="sxs-lookup"><span data-stu-id="a9a11-169">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="a9a11-170">その後、myComp.dll バージョン 2.0.0.0 を登録します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-170">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="a9a11-171">コンピューター上のすべての COM クライアント アプリケーションは myComp.dll バージョン 2.0.0.0 を使用しているため、myComponent.dll バージョン 1.0.0.0 を登録解除することにしました。</span><span class="sxs-lookup"><span data-stu-id="a9a11-171">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="a9a11-172">このレジストリ スキームでは、myComp.dll バージョン 1.0.0.0 のサブキーだけが削除されるため、バージョン 1.0.0.0 を登録解除できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-172">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="a9a11-173">Regasm.exe を使用してアセンブリを登録した後で、そのアセンブリを[グローバル アセンブリ キャッシュ](../app-domains/gac.md)内に登録すると、どの COM クライアントからもアクティブにできます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-173">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="a9a11-174">アセンブリをアクティブにするアプリケーションが 1 つだけの場合は、そのアプリケーションのディレクトリ内にアセンブリを格納できます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-174">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="a9a11-175">使用例</span><span class="sxs-lookup"><span data-stu-id="a9a11-175">Examples</span></span>

<span data-ttu-id="a9a11-176">`myTest.dll` に含まれるすべてのパブリック クラスを登録するコマンドを次に示します。</span><span class="sxs-lookup"><span data-stu-id="a9a11-176">The following command registers all public classes contained in `myTest.dll`.</span></span>

```console
regasm myTest.dll
```

<span data-ttu-id="a9a11-177">ファイル `myTest.reg` を生成するコマンドを次に示します。このファイルには、必要なレジストリ エントリがすべて含まれます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-177">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="a9a11-178">このコマンドを実行してもレジストリは更新されません。</span><span class="sxs-lookup"><span data-stu-id="a9a11-178">This command does not update the registry.</span></span>

```console
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="a9a11-179">`myTest.dll` に含まれるすべてのパブリック クラスを登録し、タイプ ライブラリ `myTest.tlb` を生成および登録するコマンドを次に示します。このタイプ ライブラリには、`myTest.dll` で定義されたすべてのパブリック型の定義が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a9a11-179">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```console
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="a9a11-180">関連項目</span><span class="sxs-lookup"><span data-stu-id="a9a11-180">See also</span></span>

- [<span data-ttu-id="a9a11-181">ツール</span><span class="sxs-lookup"><span data-stu-id="a9a11-181">Tools</span></span>](index.md)
- [<span data-ttu-id="a9a11-182">Tlbexp.exe (タイプ ライブラリ エクスポーター)</span><span class="sxs-lookup"><span data-stu-id="a9a11-182">Tlbexp.exe (Type Library Exporter)</span></span>](tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="a9a11-183">Tlbimp.exe (タイプ ライブラリ インポーター)</span><span class="sxs-lookup"><span data-stu-id="a9a11-183">Tlbimp.exe (Type Library Importer)</span></span>](tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="a9a11-184">COM へのアセンブリの登録</span><span class="sxs-lookup"><span data-stu-id="a9a11-184">Registering Assemblies with COM</span></span>](../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="a9a11-185">開発者コマンドライン シェル</span><span class="sxs-lookup"><span data-stu-id="a9a11-185">Developer command-line shells</span></span>](/visualstudio/ide/reference/command-prompt-powershell)
