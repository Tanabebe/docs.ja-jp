---
title: コンテナーとマイクロサービス ベースのアプリケーションの設計
description: コンテナーとマイクロサービス ベースのアプリケーションの設計は簡単ではないため、真剣に考える必要があります。 この章では主要な概念について説明します。
ms.date: 01/13/2021
ms.openlocfilehash: b31c560fefa0928cefef2fdb92d6cfdbac084c57
ms.sourcegitcommit: c7f0beaa2bd66ebca86362ca17d673f7e8256ca6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/23/2021
ms.locfileid: "104873147"
---
# <a name="architecting-container-and-microservice-based-applications"></a><span data-ttu-id="4aaa8-104">コンテナーとマイクロサービス ベースのアプリケーションの設計</span><span class="sxs-lookup"><span data-stu-id="4aaa8-104">Architecting container and microservice-based applications</span></span>

<span data-ttu-id="4aaa8-105">*マイクロサービスは大きな利点がありますが、大きな新しい課題を発生させます。マイクロ サービス アーキテクチャ パターンは、マイクロサービス ベースのアプリケーションを作成するときの基本的な柱です。*</span><span class="sxs-lookup"><span data-stu-id="4aaa8-105">*Microservices offer great benefits but also raise huge new challenges. Microservice architecture patterns are fundamental pillars when creating a microservice-based application.*</span></span>

<span data-ttu-id="4aaa8-106">このガイドの前半では、コンテナーと Docker の基本的な概念を学習しました。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-106">Earlier in this guide, you learned basic concepts about containers and Docker.</span></span> <span data-ttu-id="4aaa8-107">これは、コンテナーの使用を開始するために必要な最小限の情報でした。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-107">That information was the minimum you needed to get started with containers.</span></span> <span data-ttu-id="4aaa8-108">コンテナーはマイクロサービスを実現するものであり、最適なものですが、マイクロサービス アーキテクチャに必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-108">Even though containers are enablers of, and a great fit for microservices, they aren't mandatory for a microservice architecture.</span></span> <span data-ttu-id="4aaa8-109">このアーキテクチャ セクションでのアーキテクチャの概念の多くは、コンテナーなしで適用できます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-109">Many architectural concepts in this architecture section could be applied without containers.</span></span> <span data-ttu-id="4aaa8-110">しかし、既に導入されているコンテナーの重要性から、このガイドでは両方の共通部分に焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-110">However, this guide focuses on the intersection of both due to the already introduced importance of containers.</span></span>

<span data-ttu-id="4aaa8-111">エンタープライズ アプリケーションでは、複雑になることがあり、多くの場合 1 つのサービス ベースのアプリケーションではなく、複数のサービスで構成されます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-111">Enterprise applications can be complex and are often composed of multiple services instead of a single service-based application.</span></span> <span data-ttu-id="4aaa8-112">このような場合、マイクロサービス、特定のドメイン駆動型設計 (DDD) パターン、コンテナー オーケストレーションの概念など、その他のアーキテクチャの手法を理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-112">For those cases, you need to understand other architectural approaches, such as the microservices and certain Domain-Driven Design (DDD) patterns plus container orchestration concepts.</span></span> <span data-ttu-id="4aaa8-113">この章では、コンテナー上のマイクロサービスだけでなく、コンテナー化されたアプリケーションについても説明することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-113">Note that this chapter describes not just microservices on containers, but any containerized application, as well.</span></span>

## <a name="container-design-principles"></a><span data-ttu-id="4aaa8-114">コンテナー設計の原則</span><span class="sxs-lookup"><span data-stu-id="4aaa8-114">Container design principles</span></span>

<span data-ttu-id="4aaa8-115">コンテナー モデルでは、コンテナー イメージのインスタンスは 1 つのプロセスを表します。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-115">In the container model, a container image instance represents a single process.</span></span> <span data-ttu-id="4aaa8-116">コンテナー イメージをプロセス境界として定義することで、プロセスのスケーリングやバッチ処理に使用できるプリミティブを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-116">By defining a container image as a process boundary, you can create primitives that can be used to scale or batch the process.</span></span>

<span data-ttu-id="4aaa8-117">コンテナー イメージをデザインするときには、[ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint) 定義が Dockerfile に表示されます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-117">When you design a container image, you'll see an [ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint) definition in the Dockerfile.</span></span> <span data-ttu-id="4aaa8-118">この定義によって、その有効期間がコンテナーの有効期間を制御するプロセスが定義されます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-118">This definition defines the process whose lifetime controls the lifetime of the container.</span></span> <span data-ttu-id="4aaa8-119">プロセスが完了すると、コンテナーのライフサイクルが終了します。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-119">When the process completes, the container lifecycle ends.</span></span> <span data-ttu-id="4aaa8-120">コンテナーは、Web サーバーなどの実行時間の長いプロセスを表す場合がありますが、以前は Azure の [WebJobs](https://github.com/Azure/azure-webjobs-sdk/wiki) として実装される場合があったバッチ ジョブなどの有効期間が短いプロセスも表すことができます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-120">Containers might represent long-running processes like web servers, but can also represent short-lived processes like batch jobs, which formerly might have been implemented as Azure [WebJobs](https://github.com/Azure/azure-webjobs-sdk/wiki).</span></span>

<span data-ttu-id="4aaa8-121">プロセスが失敗した場合、コンテナーが終了し、Orchestrator が引き継ぎます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-121">If the process fails, the container ends, and the orchestrator takes over.</span></span> <span data-ttu-id="4aaa8-122">Orchestrator が 5 つのインスタンスの実行を維持するように構成され、1 つが失敗した場合、Orchestrator は、失敗したプロセスを置換する別のコンテナー インスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-122">If the orchestrator was configured to keep five instances running and one fails, the orchestrator will create another container instance to replace the failed process.</span></span> <span data-ttu-id="4aaa8-123">バッチ ジョブで、プロセスはパラメーターを指定して開始されます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-123">In a batch job, the process is started with parameters.</span></span> <span data-ttu-id="4aaa8-124">プロセスが完了すると、作業が完了します。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-124">When the process completes, the work is complete.</span></span> <span data-ttu-id="4aaa8-125">このガイダンスでは、後でオーケストレーターについてドリル ダウンします。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-125">This guidance drills-down on orchestrators, later on.</span></span>

<span data-ttu-id="4aaa8-126">1 つのコンテナーで複数のプロセスが実行されているシナリオが見られる場合があります。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-126">You might find a scenario where you want multiple processes running in a single container.</span></span> <span data-ttu-id="4aaa8-127">このシナリオでは、コンテナーごとに 1 つのエントリ ポイントのみが存在できるため、必要な数のプログラムを起動するスクリプトをコンテナー内で実行できます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-127">For that scenario, since there can be only one entry point per container, you could run a script within the container that launches as many programs as needed.</span></span> <span data-ttu-id="4aaa8-128">たとえば、[スーパーバイザー](http://supervisord.org/)または同様のツールを使用して、1 つのコンテナー内で複数のプロセスの起動を処理できます。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-128">For example, you can use [Supervisor](http://supervisord.org/) or a similar tool to take care of launching multiple processes inside a single container.</span></span> <span data-ttu-id="4aaa8-129">ただし、コンテナーごとに複数のプロセスを保持するアーキテクチャを探すことは可能ですが、その方法はあまり一般的ではありません。</span><span class="sxs-lookup"><span data-stu-id="4aaa8-129">However, even though you can find architectures that hold multiple processes per container, that approach isn't very common.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="4aaa8-130">[前へ](../net-core-net-framework-containers/official-net-docker-images.md)
>[次へ](containerize-monolithic-applications.md)</span><span class="sxs-lookup"><span data-stu-id="4aaa8-130">[Previous](../net-core-net-framework-containers/official-net-docker-images.md)
[Next](containerize-monolithic-applications.md)</span></span>
